# 网络安全

## 参考
- https://www.zhihu.com/question/26628342/answer/33572866
- [6种漏洞](https://mp.weixin.qq.com/s/Umd-HAbUsLBoxEOIrdZ8vg)
- [csrf防范](https://juejin.im/post/5bc009996fb9a05d0a055192)

## CSP

### 原理
  - 在HTTP Header中声明一个随机字符串，在HTML中的JavaScript标签上带了nonce属性，nonce的值和Header指定的一致才会执行对应的JavaScript代码

### 具体操作
```js
// .html or template
<script nonce="aaaa" >alert('aaaa')</script>
<script nonce="bbbb" >alert('bbbb')</script>

// 方式一：koa
// app.js
app.user(async function(ctx) {
  ctx.set('Content-Security-Policy', "script-src 'nonce-aaaa'");
  // ...
});

// 方式二：nginx
// nginx.conf
location / {
  add_header Content-Security-Policy "script-src 'nonce-aaaa'";
}
```

### 参考
1. https://www.zhihu.com/question/21979782/answer/42920769



## XSS

### 原理
  - 破坏跨层协议的数据/指令的构造，比如sql注入

### DOM-based XSS 与存储型 XSS、反射型 XSS

#### 区别
  - 存储型：比如来自数据库的持久存储的值，在页面中多处引用
  - 反射型：依赖于用户的输入

### 防御
  - escape需要同时考虑html和js
  - 请求接口前/后，对入参做escape校验


## CSRF
  - 跨站请求伪造（Cross-site request forgery）

### 防御
  - 请求携带标识，与服务端session对比








