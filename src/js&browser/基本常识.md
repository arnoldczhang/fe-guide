# åŸºæœ¬å¸¸è¯†

## å‚è€ƒ
- [æœªæ›¾æœ‰è¿‡çš„es4](https://evertpot.com/ecmascript-4-the-missing-version)
- [es5-ä¸­æ–‡å‚è€ƒæ‰‹å†Œ](http://yanhaijing.com/es5/#152)
- [ECMAScriptå„é˜¶æ®µææ¡ˆ](https://www.proposals.es/)
- [å¦‚ä½•ç”¨æ­£åˆ™å®Œç¾åŒ¹é…url](https://mathiasbynens.be/demo/url-regex)

## ç›®å½•
<details>
<summary>å±•å¼€æ›´å¤š</summary>

* [`Symbol`](#Symbol)
* [`new`](#new)
* [`String`](#String)
* [`åŸºç¡€ç±»å‹`](#åŸºç¡€ç±»å‹)
* [`ç±»å‹è½¬æ¢`](#ç±»å‹è½¬æ¢)
* [`äºŒè¿›åˆ¶`](#äºŒè¿›åˆ¶)
* [`JSON`](#JSON)
* [`Object`](#Object)
* [`Error`](#Error)
* [`Number`](#Number)
* [`this`](#this)
* [`ajaxç­‰è¯·æ±‚æ–¹å¼`](#å‰ç«¯è¯·æ±‚æ–¹å¼)
* [`Array`](#Array)
* [`Promise`](#Promise)
* [`Element`](#Element)
* [`setTimeout`](#setTimeout)
* [`å¯éå†å¯¹è±¡`](#iterator)
* [`Storage`](#Storage)
* [`ç®­å¤´å‡½æ•°`](#ç®­å¤´å‡½æ•°)
* [`null`](#null)
* [`æ­£åˆ™`](#æ­£åˆ™)
* [`cookie`](#cookie)
* [`æ¨¡å—åŒ–`](#æ¨¡å—åŒ–)
* [`å…¶ä»–`](#å…¶ä»–)
* [`ç»§æ‰¿`](#ç»§æ‰¿)
* [`æ·±æ‹·è´`](#æ·±æ‹·è´)
* [`åæ¨¡å¼`](#åæ¨¡å¼)
* [`é€’å½’`](#é€’å½’)
* [`å­—èŠ‚`](#å­—èŠ‚)
* [`èŠ‚æµvsé˜²æŠ–`](#èŠ‚æµvsé˜²æŠ–)
* [`æ–‡ä»¶ä¸‹è½½`](#æ–‡ä»¶ä¸‹è½½)
* [`å¾®å‰ç«¯`](#å¾®å‰ç«¯)

</details>

## String

### indexOf VS search
- search:é»˜è®¤å¤„ç†æ­£åˆ™ï¼Œæ¯”å¦‚'aaa\n'.search('.')ï¼Œæ˜¯0ï¼Œå› ä¸º/./
- indexOf:å¤„ç†å­—ç¬¦ä¸²ï¼ŒåŒæ˜¯å­—ç¬¦ä¸²ï¼Œç•¥å¿«

### valueOf VS toString
- ç±»å‹è½¬æ¢æ—¶ï¼Œä¼˜å…ˆè°ƒç”¨valueOf()æ–¹æ³•ï¼Œç„¶åé€šè¿‡toStringæŠ½è±¡æ“ä½œå°†è¿”å›å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²
```js
function Foo(n) {
  this.number = n;
}

Foo.prototype.valueOf = function() {
  return 123;
};

var obj = new Foo;
obj + 1; // æ­¤æ—¶è¾“å‡º124

Foo.prototype.valueOf = function() {
  return 321;
};

obj + 1; // æ­¤æ—¶è¾“å‡º322
```

### +
- æ“ä½œæ•°æ˜¯stringï¼Œåšæ‹¼æ¥ï¼Œå¦åˆ™åšç›¸åŠ ï¼›
- æ“ä½œæ•°æ˜¯objectï¼ŒåštoPrimitiveï¼ˆvalueOfæˆ–toStringï¼‰ï¼Œå†æŒ‰ï¼ˆ1ï¼‰åˆ¤æ–­ï¼›



### == VS ===



#### ç›¸ç­‰ï¼ˆ==ï¼‰

| ç±»å‹                 | æ¯”è¾ƒæ–¹å¼                               |
| -------------------- | -------------------------------------- |
| ä¸¤ä¸ªå€¼ç±»å‹           | è½¬æˆç›¸åŒç±»å‹å†æ¯”è¾ƒ                     |
| ä¸¤ä¸ªå¼•ç”¨ç±»å‹         | æ¯”è¾ƒå¼•ç”¨                               |
| ä¸€ä¸ªå€¼ï¼Œä¸€ä¸ªå¼•ç”¨ç±»å‹ | å¼•ç”¨ç±»å‹çš„æ•°æ®è½¬ä¸ºå€¼ç±»å‹ç›¸åŒæ•°æ®å†æ¯”è¾ƒ |



#### ç›¸åŒï¼ˆ===ï¼‰

| ç±»å‹                 | æ¯”è¾ƒæ–¹å¼                   |
| -------------------- | -------------------------- |
| ä¸¤ä¸ªå€¼ç±»å‹           | æ•°æ®ç±»å‹ä¸åŒï¼Œå¿…ç„¶â€œä¸ç›¸åŒâ€ |
| ä¸¤ä¸ªå¼•ç”¨ç±»å‹         | æ¯”è¾ƒå¼•ç”¨                   |
| ä¸€ä¸ªå€¼ï¼Œä¸€ä¸ªå¼•ç”¨ç±»å‹ | å¿…ä¸åŒ                     |

== å…è®¸åœ¨ç›¸ç­‰æ¯”è¾ƒä¸­è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè€Œ === ä¸å…è®¸ã€‚

### å­—ç¬¦ä¸²å’Œæ•°å­—ä¹‹é—´çš„ç›¸ç­‰æ¯”è¾ƒ
- å¦‚æœ Type(x) æ˜¯æ•°å­—ï¼ŒType(y) æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› x == ToNumber(y) çš„ç»“æœã€‚ 
- å¦‚æœ Type(x) æ˜¯å­—ç¬¦ä¸²ï¼ŒType(y) æ˜¯æ•°å­—ï¼Œåˆ™è¿”å› ToNumber(x) == y çš„ç»“æœã€‚
- å¦åˆ™è¿”å› ToBoolean(x) == ToBoolean(y)çš„ç»“æœã€‚

### å¯¹è±¡å’Œéå¯¹è±¡ä¹‹é—´çš„ç›¸ç­‰æ¯”è¾ƒ
- ToPromitiveé»˜è®¤è½¬æ•°å­—ï¼›
- å¦‚æœ Type(x) æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼ŒType(y) æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å› x == ToPrimitive(y) çš„ç»“æœï¼›
- å¦‚æœ Type(x) æ˜¯å¯¹è±¡ï¼ŒType(y) æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œåˆ™è¿”å› ToPromitive(x) == y çš„ç»“æœï¼›

### codePointAt
charCodeAtå‡çº§ç‰ˆï¼Œç”¨äºå¤„ç†å¢è¡¥å­—ç¬¦ã€å¢è¡¥å­—ç¬¦é•¿åº¦æ˜¯2ã€‘

---

## åŸºç¡€ç±»å‹
- null
- undefined
- boolean
- number
- string
- symbol

### ç‰¹æ€§
- ä¸å˜æ€§
- æ²¡æœ‰å±æ€§ã€__proto__
- ä»»ä½•çš„å±æ€§è®¿é—®ï¼Œéƒ½æ˜¯è®¿é—®åŸºç¡€åŒ…è£…ç±»å‹
  * åˆ›å»ºåŸºç¡€ç±»å‹çš„ä¸€ä¸ªå®ä¾‹
  * åœ¨å®ä¾‹ä¸Šè°ƒç”¨æŒ‡å®šçš„æ–¹æ³•
  * é”€æ¯å®ä¾‹

---

## ç±»å‹è½¬æ¢

è½¬æ¢åŸå§‹ç±»å‹ä¼šæ‰§è¡ŒåŸç”Ÿçš„toPrimitive

1. è¿”å›å½“å‰å€¼ï¼ˆå¦‚æœå·²æ˜¯åŸå§‹ç±»å‹ï¼‰
2. è½¬stringï¼Œå…ˆtoStringï¼Œå†valueOf
3. ä¸æ˜¯è½¬stringï¼Œå…ˆvalueOfï¼Œå†toString

```js
let num = {
  valueOf() {
    return 1;
  },
  toString() {
    return '2';
  },
  // ä¼˜å…ˆçº§æœ€é«˜
  [Symbol.toPrimitive]() {
    return 3;
  }
};
```

### è½¬æ¢ä¸ºå¸ƒå°”å€¼

| å‚æ•°ç±»å‹ | ç»“æœ |
| ------ | ------ |
| Undefined | false |
| Null | false |
| Boolean | å½“å‰å‚æ•° |
| Number | å¦‚æœå‚æ•°ä¸º +0ã€ -0æˆ– NaNï¼Œåˆ™è¿”å› falseï¼›å…¶ä»–æƒ…å†µåˆ™è¿”å› true |
| String | å¦‚æœå‚æ•°ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› falseï¼›å¦åˆ™è¿”å› true |
| Symbol | true |
| Object | true |

### è½¬æ¢ä¸ºæ•°å­—

| å‚æ•°ç±»å‹ | ç»“æœ |
| ------ | ------ |
| Undefined | NaN |
| Null | +0 |
| Boolean | å¦‚æœå‚æ•°ä¸º trueï¼Œåˆ™è¿”å› 1ï¼› falseåˆ™è¿”å› +0 |
| Number | è¿”å›å½“å‰å‚æ•° |
| String | å…ˆè°ƒç”¨ ToPrimitiveï¼Œå†è°ƒç”¨ ToNumberï¼Œç„¶åè¿”å›ç»“æœ |
| Symbol | æŠ›å‡º TypeErroré”™è¯¯ |
| Object | å…ˆè°ƒç”¨ ToPrimitiveï¼Œå†è°ƒç”¨ ToNumberï¼Œç„¶åè¿”å›ç»“æœ |

### è½¬æ¢ä¸ºå­—ç¬¦ä¸²

| å‚æ•°ç±»å‹ | ç»“æœ |
| ------ | ------ |
| Undefined | è¿”å› "undefined" |
| Null | è¿”å› "null" |
| Boolean | å¦‚æœå‚æ•°ä¸º true ,åˆ™è¿”å› "true"ï¼›å¦åˆ™è¿”å› "false" |
| Number | è°ƒç”¨ NumberToStringï¼Œç„¶åè¿”å›ç»“æœ |
| String | è¿”å› å½“å‰å‚æ•° |
| Symbol | æŠ›å‡º TypeErroré”™è¯¯ |
| Object | å…ˆè°ƒç”¨ ToPrimitiveï¼Œå†è°ƒç”¨ ToStringï¼Œç„¶åè¿”å›ç»“æœ |

---

## äºŒè¿›åˆ¶

### åŸç 
ç¬¦å·ä½ + çœŸå€¼

### åç 
æ­£æ•° - æœ¬èº«
è´Ÿæ•° - åœ¨åŸç çš„åŸºç¡€ä¸Š, ç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™å„ä¸ªä½å–å

### è¡¥ç 
æ­£æ•° - æœ¬èº«
è´Ÿæ•° - åœ¨åŸç çš„åŸºç¡€ä¸Š, ç¬¦å·ä½ä¸å˜, å…¶ä½™å„ä½å–å, æœ€å+1. (å³åœ¨åç çš„åŸºç¡€ä¸Š+1)

---

## æ­£åˆ™

- [å¸¸ç”¨è¯­è¨€æ­£åˆ™ç‰¹æ€§ä¸€è§ˆ](https://github.com/yurii-yu/regexs/blob/master/feature_overview.md)
- [æœªæ¥çš„æ­£åˆ™](https://ponyfoo.com/articles/regular-expressions-post-es6)

### ç‰¹æ®Šç”¨æ³•
**åŒ¹é…æ‰€æœ‰**

[^]

**éè´ªå©ª**
\w+?

### è½¬ä¹‰å­—ç¬¦
- * . ? + $ ^ [ ] ( ) { } | \ /

### exec VS match
- execä¼šå¸¦lastIndexï¼Œmatchä¸ä¼š
ä¾‹ï¼šæ­£åˆ™é€’å½’
```js
var str = 'abc';
var reg = /\w/g;
var result;
while (result = reg.exec(str)) {
  console.log(result);
}
```

---

## Error
æ•è·å¼‚æ­¥é”™è¯¯unhandledrejection
```js
window.addEventListener('unhandledrejection', function (event) {
  // ...
  event.preventDefault();
});
```

---

## Number

### 0.1 + 0.2 !== 0.3
1. è¿›åˆ¶è½¬æ¢
  - è®¡ç®—æœºæ— æ³•ç›´æ¥å¯¹åè¿›åˆ¶æ•°è®¡ç®—ï¼Œéœ€è¦å¯¹ç…§IEEE 754æ ‡å‡†ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶
  - IEEEåŒç²¾åº¦æ ¼å¼å…·æœ‰53 ä½æœ‰æ•ˆæ•°å­—ç²¾åº¦(åŒ…å«1ä½ç¬¦å·ä½)ï¼Œå¹¶æ€»å…±å ç”¨64 ä½
  - å°æ•°è½¬æ¢å®Œä¹‹åéœ€è¦åšå°¾æ•°æˆªæ–­ï¼Œå¤šä½™å°¾æ•°æˆªæ‰åå°±ä¼šé€ æˆç²¾åº¦æŸå¤±
  - Number.MAX_SAFE_INTEGER 2çš„53æ¬¡æ–¹ - 1
  ```js
  // 9007199254740991
  // 
  // (0.1)10 => (0.00011001100110011001(1001å¾ªç¯)...)2
  // (0.2)10 => (0.00110011001100110011(0011å¾ªç¯)...)2
  ```
2. å¯¹é˜¶è¿ç®—
  - ç”±äºæŒ‡æ•°ä½æ•°ä¸ç›¸åŒï¼Œè¿ç®—æ—¶éœ€è¦å¯¹é˜¶è¿ç®— è¿™éƒ¨åˆ†ä¹Ÿå¯èƒ½äº§ç”Ÿç²¾åº¦æŸå¤±
  - 0.1 + 0.2çš„ç»“æœå°±æ˜¯ï¼š
  ```js
  // 0.30000000000000004
  0.0100110011001100110011001100110011001100110011001100
  ```

---

## æ³›ç”¨å‹isObject
- ç±»ä¼¼new String('aa')ä»ä¸ç®—object
```js
function isProxyable(value) {
  if (!value) return false;
  if (typeof value !== "object") return false;
  if (Array.isArray(value)) return true;
  const proto = Object.getPrototypeOf(value);
  return proto === null || proto === Object.prototype;
};
```

---

## å‰ç«¯è¯·æ±‚æ–¹å¼
[å‰ç«¯æ‰€æœ‰ç½‘ç»œè¯·æ±‚æ–¹å¼](https://mp.weixin.qq.com/s/LKcEylaxb21_GeCXoGZ8fA)

### å˜è¿
- formè¡¨å•ã€ifreamã€åˆ·æ–°é¡µé¢
- Ajax - å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„å¼€å±±é¼»ç¥–
- jQuery - ä¸€ä¸ªæ—¶ä»£
- fetch - Ajaxçš„æ›¿ä»£è€…
- axiosã€requestç­‰ä¼—å¤šå¼€æºåº“

### readystate
- 0: è¯·æ±‚æœªåˆå§‹åŒ–ï¼ˆè¿˜æ²¡æœ‰è°ƒç”¨ open()ï¼‰ã€‚
- 1: è¯·æ±‚å·²ç»å»ºç«‹ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å‘é€ï¼ˆè¿˜æ²¡æœ‰è°ƒç”¨ send()ï¼‰ã€‚
- 2: è¯·æ±‚å·²å‘é€ï¼Œæ­£åœ¨å¤„ç†ä¸­ï¼ˆé€šå¸¸ç°åœ¨å¯ä»¥ä»å“åº”ä¸­è·å–å†…å®¹å¤´ï¼‰ã€‚
- 3: è¯·æ±‚åœ¨å¤„ç†ä¸­ï¼›é€šå¸¸å“åº”ä¸­å·²æœ‰éƒ¨åˆ†æ•°æ®å¯ç”¨äº†ï¼Œä½†æ˜¯æœåŠ¡å™¨è¿˜æ²¡æœ‰å®Œæˆå“åº”çš„ç”Ÿæˆã€‚
- 4: å“åº”å·²å®Œæˆï¼›æ‚¨å¯ä»¥è·å–å¹¶ä½¿ç”¨æœåŠ¡å™¨çš„å“åº”äº†ã€‚

## Object.getOwnPropertyDescriptor
```js
var obj = {};
Object.defineProperty(obj, aa, {
  get() {/*...*/},
  set() {/*...*/},
});

Object.getOwnPropertyDescriptor(obj);
/*
  {
    get(){},
    set(){},
    configurable: true,
    enumerable: true,
  }
*/
```

### fetch VS XMLHttpRequest

- [å¦‚ä½•ä½¿ç”¨fetchå’Œxmlæ‹¦æˆªé‡å®šå‘401](https://mp.weixin.qq.com/s/IW8Y4nHsW5Si2Q1rgCIXUg)

ç›¸æ¯”XMLHttpRequestï¼Œfetchå¯å¯¹è¯·æ±‚åšæ›´å¤šæ§åˆ¶
- credentials
- mode
- cache
- redirectï¼ˆ**redirect=manual**è¡¨ç¤ºä¸å¤„ç†é‡å®šå‘ï¼‰
- referrer
- integrity

#### credentials
è¯·æ±‚æ˜¯å¦å¸¦ä¸Š cookie ç­‰æœºå¯†ä¿¡æ¯ï¼ˆè·¨åŸŸæƒ…å†µé»˜è®¤ä¸å¸¦çš„ï¼‰

fetch
- omit: è¯·æ±‚ä¸å¸¦ä»»ä½• cookie
- same-origin: åŒåŸŸè¯·æ±‚ä¼šå¸¦ä¸Š cookie
- include: æ— è®ºæ˜¯å¦è·¨åŸŸéƒ½ä¼šå¸¦ä¸Š cookie

XMLHttpRequest (withCredentials)
- true: å¤§è‡´å¯¹åº”ä¸Šé¢çš„ includeï¼ŒMDN ä¸Šæè¿°æ­¤ flag ä¸æ­¢æ§åˆ¶ cookie è¿˜æ§åˆ¶ authorization headers æˆ–è€… TLS client certificatesã€‚
- false: å¤§è‡´å¯¹åº”ä¸Šé¢çš„ omitï¼ŒMDN ä¸Šæè¿°ä¸º false æ—¶è¿˜æ§åˆ¶è·¨åŸŸè¯·æ±‚çš„ response ä¸èƒ½è®¾ç½® cookieã€‚

#### mode
è®¾ç½®è¯·æ±‚æ–¹å¼çš„é˜»æ­¢è·¨åŸŸæ ‡å¿—ä½

fetch
- same-origin
- no-cors
- cors
- navigate

#### åŒæ­¥è¯·æ±‚

XMLHttpRequestç¬¬ä¸‰ä¸ªå‚æ•°æ”¯æŒè®¾ç½®åŒæ­¥è¯·æ±‚ï¼Œä½†å±å®³å°±æ˜¯åé¢çš„**äº‹ä»¶å¾ªç¯éƒ½ä¼šè¢«é˜»å¡**ã€‚



---

## JSON

### toJSON
- å¦‚æœå¯¹è±¡ä¸­å®šä¹‰äº†toJSON() æ–¹æ³•ï¼Œstringifyä¼šé¦–å…ˆè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå†ç”¨å®ƒçš„è¿”å› å€¼æ¥è¿›è¡Œåºåˆ—åŒ–
```js
var obj = {
  toJSON() {
    return 'aaa';
  },
};
```

### æ”¯æŒçš„æ•°æ®ç±»å‹
ç”±äºJSONæ˜¯é€šç”¨æ–‡æœ¬æ ¼å¼ï¼Œå’Œè¯­è¨€æ— å…³ï¼Œæ‰€ä»¥æ— æ³•é’ˆå¯¹è¯­è¨€çš„ç‰¹å®šæ•°æ®ç±»å‹åšè½¬æ¢
- String
- Number
- Null
- Boolean

### stringify
- Boolean | Number| String ç±»å‹ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚
- undefinedã€ä»»æ„å‡½æ•°ä»¥åŠsymbolï¼Œä¼šè¢«å¿½ç•¥ï¼ˆå‡ºç°åœ¨éæ•°ç»„å¯¹è±¡çš„å±æ€§å€¼ä¸­æ—¶ï¼‰ï¼Œ
  æˆ–è€…è¢«è½¬æ¢æˆ nullï¼ˆå‡ºç°åœ¨æ•°ç»„ä¸­æ—¶ï¼‰ã€‚
- ä¸å¯æšä¸¾çš„å±æ€§ä¼šè¢«å¿½ç•¥
- å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§å€¼é€šè¿‡æŸç§é—´æ¥çš„æ–¹å¼æŒ‡å›è¯¥å¯¹è±¡æœ¬èº«ï¼Œå³å¾ªç¯å¼•ç”¨ï¼Œå±æ€§ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚

**å…¥å‚**

- input
- replacement
  * keyæ›¿æ¢æ–¹æ³•ï¼Œæ·±åº¦éå†
  * function(key, value)ï¼Œreturnå€¼ä¸ºæ›¿ä»£å€¼
- space

---

## this

- æµè§ˆå™¨å…¨å±€ç¯å¢ƒï¼Œwindow
- nodeå…¨å±€ç¯å¢ƒï¼Œ Global {}
- å‡½æ•°åœ¨newä¸­è°ƒç”¨(newç»‘å®š)çš„è¯ï¼Œthisç»‘å®šçš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚
  ```js
  var bar = new foo();
  ```
- å‡½æ•°æ˜¯å¦é€šè¿‡callã€apply(æ˜¾å¼ç»‘å®š)æˆ–è€…ç¡¬ç»‘å®šè°ƒç”¨ï¼Œthisç»‘å®šçš„æ˜¯æŒ‡å®šçš„å¯¹è±¡ã€‚
  ```js
  var bar = foo.call(obj2);
  var bar2 = foo.apply(obj2);
  var bar3 = foo.bind(obj2);
  ```
- å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨(éšå¼ç»‘å®š)ï¼Œthis ç»‘å®šçš„æ˜¯é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚
  ```js
  var bar = obj1.foo();
  ```
- ç®­å¤´å‡½æ•°ç»‘å®šå¤–å±‚ä¸Šä¸‹æ–‡ç¯å¢ƒ
- å¦‚æœéƒ½ä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨é»˜è®¤ç»‘å®šã€‚ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ°undefinedï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚
  ```js
  var bar = foo();
  ```

### thisæ˜¾å¼ç»‘å®š
```js
class MeowctComponent {
  constructor() {
    this.paw = document.getElementById('button');
  }

  meow() {
    console.info('ğŸ± on this: ', this.paw);
  }
}
const cat = new MeowctComponent();

// æ–¹å¼1ï¼šç®­å¤´å‡½æ•°
cat.paw.addEventListener('click', () => cat.meow());
// æ–¹å¼2ï¼šbind
cat.paw.addEventListener('click', cat.meow.bind(cat));
// æ–¹å¼3ï¼šç»‘å®šæ“ä½œç¬¦::ï¼ˆææ¡ˆï¼‰
cat.paw.addEventListener('click', ::cat.meow);
```

### call/apply
[å‚è€ƒ](../fe-interview/src/call&apply.js)

### ECMAScriptçš„ç±»å‹
- è¯­è¨€ç±»å‹
  * 7å¤§åŸºæœ¬ç±»å‹
- è§„èŒƒç±»å‹
  * Reference
  * List
  * Completion
  * Property Descriptor
  * Property Identifier
  * Lexical Environment
  * Environment Record

#### Reference
- base value
- referenced name
- strict reference
- GetBase/GetValue
  * è¿”å›çš„å°†æ˜¯å…·ä½“çš„å€¼ï¼Œè€Œä¸å†æ˜¯ä¸€ä¸ª Reference
- IsPropertyReference
  * å¦‚æœ base value æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±è¿”å›true

```js
var value = 1;

var foo = {
  value: 2,
  bar: function () {
    return this.value;
  }
}

//2
console.log(foo.bar());
//2
console.log((foo.bar)());
//1
// èµ‹å€¼æ“ä½œç¬¦ï¼ŒLet rval be GetValue(rref)
console.log((foo.bar = foo.bar)());
//1
// é€»è¾‘è¿ç®—ç¬¦ï¼ŒLet lval be GetValue(lref)
console.log((false || foo.bar)());
//1
// é€—å·æ“ä½œç¬¦ï¼ŒCall GetValue(lref)
console.log((foo.bar, foo.bar)());
```

---

## new

### newå…³é”®å­—
- å‚è€ƒecma262-12.3.3
- åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å‹æ˜¯object
- é“¾æ¥åˆ°åŸå‹: obj.__proto__ = Con.prototype
(è®¾ç½®è¿™ä¸ªæ–°çš„å¯¹è±¡çš„å†…éƒ¨ã€å¯è®¿é—®æ€§å’Œ[[Prototype]]å±æ€§ä¸ºæ„é€ å‡½æ•°ï¼ˆæŒ‡prototype.construtoræ‰€æŒ‡å‘çš„æ„é€ å‡½æ•°ï¼‰ä¸­è®¾ç½®çš„)
- ç»‘å®šthis: apply
(æ‰§è¡Œ[[Construct]]ï¼Œå½“thiså…³é”®å­—è¢«æåŠçš„æ—¶å€™ï¼Œä½¿ç”¨æ–°åˆ›å»ºçš„å¯¹è±¡çš„å±æ€§)
- è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼ˆé™¤éæ„é€ æ–¹æ³•ä¸­è¿”å›çš„æ˜¯â€˜æ— åŸå‹â€™ï¼‰

### å®ç°
æ³¨ï¼šå¦‚æœå®ä¾‹åŒ–è¿”å›çš„æ˜¯å¯¹è±¡ï¼ˆénullï¼‰æˆ–functionï¼Œé‚£å°±å–è¿™ä¸ªå€¼

```js
function nNew() {
  const [Ctor, ...args] = arguments;
  const result = {};
  // ç°ä»£æµè§ˆå™¨ä¸æ¨èç›´æ¥æ”¹_proto__ï¼Œæ¨èç”¨Object.create
  // å‚è€ƒèµ„æ–™ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf
  // result.__proto__ = Ctor.prototype;
  Object.setPrototypeOf(result, Ctor.prototype);
  const ctorRes = Ctor.apply(result, args);
  if (ctorRes && typeof ctorRes === 'object' || typeof ctorRes === 'function') {
    return ctorRes;
  }
  return result;
};

// è°ƒç”¨
function Aa(word) {
  this.word = word;
};
const a = nNew(Aa, 'hello');
a.word; // hello
```

### åˆ¤æ–­æ˜¯å¦æ˜¯newè°ƒç”¨
```js
class Parent {
  constructor() {
    if (new.target === Parent) {
      console.log( "Parent instantiated" );
    }
    else {
      console.log( "A child instantiated" );
    }
  }
}
```

### instanceof
å®ä¾‹çš„åŸå‹å¯¹è±¡é“¾ä¸­ï¼Œèƒ½å¦æ‰¾åˆ°è¯¥æ„é€ å‡½æ•°çš„prototypeå±æ€§æ‰€æŒ‡å‘çš„åŸå‹å¯¹è±¡

---

## Object

### åˆ›å»ºå¯¹è±¡
```js
var atom = {/* ... */};
var atom = Object.create(null);
var atom = new Foo;
var atom = Foo.call(/* ... */);
var atom = Object.setPrototypeOf(new Object, null);
```

æ³¨ï¼šä»»ä½•æƒ…å†µä¸‹éƒ½è¦è€ƒè™‘`Object.create`æ›¿ä»£`Object.setPrototypeOf`

å¼•ç”¨ mdn çš„è§£é‡Šï¼š

```
è­¦å‘Š: ç”±äºç°ä»£ JavaScript å¼•æ“ä¼˜åŒ–å±æ€§è®¿é—®æ‰€å¸¦æ¥çš„ç‰¹æ€§çš„å…³ç³»ï¼Œæ›´æ”¹å¯¹è±¡çš„ [[Prototype]]åœ¨å„ä¸ªæµè§ˆå™¨å’Œ JavaScript å¼•æ“ä¸Šéƒ½æ˜¯ä¸€ä¸ªå¾ˆæ…¢çš„æ“ä½œã€‚å…¶åœ¨æ›´æ”¹ç»§æ‰¿çš„æ€§èƒ½ä¸Šçš„å½±å“æ˜¯å¾®å¦™è€Œåˆå¹¿æ³›çš„ï¼Œè¿™ä¸ä»…ä»…é™äº obj.__proto__ = ... è¯­å¥ä¸Šçš„æ—¶é—´èŠ±è´¹ï¼Œè€Œä¸”å¯èƒ½ä¼šå»¶ä¼¸åˆ°ä»»ä½•ä»£ç ï¼Œé‚£äº›å¯ä»¥è®¿é—®ä»»ä½•[[Prototype]]å·²è¢«æ›´æ”¹çš„å¯¹è±¡çš„ä»£ç ã€‚å¦‚æœä½ å…³å¿ƒæ€§èƒ½ï¼Œä½ åº”è¯¥é¿å…è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„ [[Prototype]]ã€‚ç›¸åï¼Œä½ åº”è¯¥ä½¿ç”¨ Object.create()æ¥åˆ›å»ºå¸¦æœ‰ä½ æƒ³è¦çš„[[Prototype]]çš„æ–°å¯¹è±¡ã€‚
```

### å¯¹è±¡keyç‰¹ç‚¹
- keyåªèƒ½æ˜¯stringæˆ–è€…Symbol
- å½“keyä¸ºå…¶ä»–ç±»å‹ï¼Œæ¯”å¦‚Objectï¼Œä¼šè‡ªåŠ¨toStringï¼ˆä¹Ÿå°±æ˜¯[object Object])

### Object.keys
å‚è§[Object.keys](Object.keys.md)

### Object.preventExtensionsã€Object.sealã€Object.freeze
- http://www.cnblogs.com/snandy/p/5278474.html

### å¯¹è±¡åˆ é™¤ä¸éœ€è¦çš„å±æ€§
```js
const obj = {
  a: 1,
  b: 2,
  c: 3,
  d: 4,
};

const {
  a,
  b,
  ...cleanObject,
} = obj;

console.log(cleanObject);
```

### åˆå¹¶å¯¹è±¡
```js
const obj = {
  a: 1,
  b: 2,
};

const obj2 = {
  c: 3,
  d: 4,
};

const obj3 = {...obj, ...obj2};
console.log(obj3);
```

### for...ofå¯¹è±¡
```js
for (const k of Object.keys(obj)) ... // enumerable own keys
for (const [k, v] of Object.entries(obj)) ... // enumerable own [key, value]s
for (const k of Object.getOwnPropertyNames(obj)) // all own keys
for (const s of Object.getOwnPropertySymbols(obj)) // all own symbols
for (const k of Reflect.ownKeys(obj)) // all own keys (include symbols)
```

### Object.is
- ç±»ä¼¼===
- åŒºåˆ«
  * Object.is(+0, -0) === false
  * Object.is(NaN, NaN) === true

**polyfill**

```js
Object.is = function(pre, next) {
  if (pre === next) {
    // +0/-0
    return pre !== 0 || 1 / pre === 1 / next;
  } else {
    // NaN
    return pre !== pre && next !== next;
  }
};
```

---

## Promise
-- æœªæ¥äº‹ä»¶çš„è¡¨ç¤º

[v8-promise](https://github.com/v8/v8/blob/4b9b23521e6fd42373ebbcb20ebe03bf445494f9/src/objects/promise.h)

### éƒ¨åˆ†ç‰¹æ€§

#### then/catchè¿”å›promiseæœ¬èº«
```js
// TypeError: Chaining cycle detected for promise #<Promise>
const promise = Promise.resolve()
  .then(() => {
    return promise
  })
promise.catch(console.error);
```

#### then/catchå€¼ç©¿é€
```js
Promise.resolve(1)
  .then(2)
  .then(Promise.resolve(3))
  .then(console.log)
// console.log: 1
// callbackä¼ å…¥éå‡½æ•°ï¼Œåšå€¼ç©¿é€
```

### Promise.all

type: Promise.all(iterable)
result: rejectable / Array<resolvable>

**åªè¦ä¸€ä¸ªç»“æœæ˜¯rejectå°±è¿›error**

[ä½•ä¸ºiterable](../fe-interview/src/common.md#å¯è¿­ä»£å¯¹è±¡)

```js
async function getFullPost() {
  return await Promise.all([
    fetch('/aa'),
    fetch('/bb')
  ]);
};

const [aa, bb] = getFullPost();
```

**ä¹Ÿå¯ä»¥ä¼ å…¥iterator**

```js
const iterator = {
  [Symbol.iterator]() {
    let index = 0;
    return {
      next() {
        return {
          value: Promise.resolve(index++),
          done: index > 2,
        };
      },
    };
  },
};

Promise.all(iterator).then(res => console.log(res)); // [1, 2]
```

### Promise.allè¿”å›å¯¹è±¡
```js
async function func(deps) {
  return deps.reduce(async(t, v) => {
    const res = await t;
    const version = await request(v);
    res[v] = version;
    return res;
  }, Promise.resolve({}));
}
const result = await func(); // éœ€åœ¨asyncåŒ…å›´ä¸‹ä½¿ç”¨
```

### Promise.prototype.cancel

**è°ƒç”¨cancelåï¼Œæœªè§¦å‘çš„cbéƒ½ä¸ä¼šæ‰§è¡Œ**

```js
function CancelPromise(cb) {
  this.promise = new Promise(cb);
  this.canceled = false;
};

CancelPromise.prototype = {
  cancel() {
    this.canceled = true;
  },

  then(cb) {
    cb = (data) => {
      if (!this.canceled) {
        cb(data);
      }
    };
    return this.promise.then(cb);
  },
};

// test
const p1 = new CancelPromise((resolve, reject) => {
  setTimeout(() => {
    resolve(123);
  }, 3000);
});

setTimeout(() => {
  p1.cancel();
}, 1000);

p1.then((data) => {
  console.log(data);
});
```

### Promise.race

**ä¾‹1**
- åŠ è½½å¤šå¼ å›¾ç‰‡ï¼Œä¼˜å…ˆè¿”å›çš„å–ä¸ºç›®æ ‡å›¾ç‰‡ï¼Œä¼˜å…ˆè¿”å›çš„å¦‚æœæŠ¥é”™åˆ™ä¸å–
- è€ƒè™‘å¼‚å¸¸æƒ…å†µ

```js
// ç¬¬ä¸€ä¸ªå›¾ç‰‡
const p1 = new Promise((resolve, reject) => {
  setTimeout(() => {
    // if (/*æˆåŠŸ*/) {
    //   resolve(1);
    // } else {
    //   // ä»€ä¹ˆä¹Ÿä¸åš
    // }
  }, 1000);
});

// ç¬¬äºŒä¸ªå›¾ç‰‡
const p2 = new Promise((resolve, reject) => {
  setTimeout(() => {
    // if (/*æˆåŠŸ*/) {
    //   resolve(2);
    // } else {
    //   // ä»€ä¹ˆä¹Ÿä¸åš
    // }
  }, 2000);
});

// å…œåº•å›¾ç‰‡
const p3 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve(3);
  }, 3000);
});

Promise.race([p1, p2, p3]).then((res) => {
  console.log(res);
}).catch((err) => {
  console.log('err', err);
});
```

### Promise.finally
> æ— è®ºä¹‹å‰æ‰§è¡Œthen/catchï¼Œéƒ½ä¼šè§¦å‘
> ç›´æ¥é€ä¼ ä¹‹å‰çš„è¿”å›å€¼ï¼Œä¾›åé¢çš„then/catchä½¿ç”¨

```js
Promise.prototype.finally = function (callback) {
  let P = this.constructor;
  return this.then(
    value  => P.resolve(callback(value)).then(() => value),
    reason => P.resolve(callback(reason)).then(() => { throw reason })
  );
};
```

### Promise.first

**è¿”å›ç¬¬ä¸€ä¸ªresolveçš„promiseå€¼**

```js
Promise.first = function(promises) {
  let count = 0;
  return new Promise((resolve, reject) => {
    promises.forEach((promise) => {
      promise.then((res) => {
        resolve(res);
      }, () => {
        count++;
        if (count >= promises.length) {
          reject('all reject');
        }
      });
    });
  });
};

// test
const p1 = new Promise((resolve, reject) => {
  reject(1);
});

const p2 = new Promise((resolve, reject) => {
  resolve(2);
});

const p3 = new Promise((resolve, reject) => {
  reject(3);
});

Promise.first([p1, p2, p3])
  .then(res => console.log(res))
  .catch(err => console.log(err));
```

### Promise.last

**è¿”å›æœ€åä¸€ä¸ªresolveçš„promiseå€¼**

```js
Promise.last = function(promises) {
  let count = 0;
  let last = null;

  return new Promise((resolve, reject) => {
    const checkLast = () => {
      count += 1;
      if (count >= promises.length) {
        resolve(last);
      }
    };
    promises.forEach((promise) => {
      promise.then((res) => {
        last = res;
        checkLast();
      }, checkLast);
    });
  });
};

const p1 = new Promise((resolve, reject) => {
  reject(1);
});

const p2 = new Promise((resolve, reject) => {
  resolve(2);
});

const p3 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve(3);
  }, 2000);
});

Promise.last([p1, p2, p3])
  .then(res => console.log(res))
  .catch(err => console.log(err));
```

### Promise.allSettled

**ä¸Promise.allç›¸å¯¹ç«‹ï¼Œæœ‰rejectä¸ä¼šçŸ­è·¯**

```js
Promise.allSettled([
  Promise.resolve(1),
  Promise.reject(0)
]); // Promise {<resolved>: Array(2)}
```

### Promise.none

**æ‰€æœ‰çš„promiseéƒ½è¢«æ‹’ç»äº†ï¼Œåˆ™Promise.noneå˜æˆå®ŒæˆçŠ¶æ€**

### Promise.any

**åªè·å–æ‰€æœ‰çš„promiseä¸­è¿›å…¥å®ŒæˆçŠ¶æ€çš„ç»“æœï¼Œè¢«æ‹’ç»çš„åˆ™å¿½ç•¥æ‰**

### Promise.every

**æ‰€æœ‰çš„promiseéƒ½è¿›å…¥å®ŒæˆçŠ¶æ€ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false**

### async/awaitVSgenerator
- awaitä¼šç­‰å¾…åé¢ç»“æœï¼Œå†æ‰§è¡Œä¸‹é¢è¯­å¥ï¼Œå¦‚æœåœ¨å‡½æ•°å†…ï¼Œä»…å¯¹å‡½æ•°å†…è¯­å¥èµ·é˜»å¡ä½œç”¨
- asyncæ˜¯Generatorå‡½æ•°çš„è¯­æ³•ç³–ã€‚
- asyncå‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆasyncï¼Œå°†yieldæ›¿æ¢æˆawait
```js
function *foo() {
  yield 1;
  yield 2;
  yield 3;
};

var f = foo();
f.next();
// { value: 1, done: false }
// ...
```

```js
async function run() {
  async function aa() {
    return new Promise((res) => {
      setTimeout(() => { res(['a', 'b', 'c'])}, 3000);
    });
  };

  var aaRes = await aa();

  for await (const friend of aaRes) {
    console.log(friend);
  }
};
```

### setTimeoutæ¨¡æ‹Ÿpromise

å¸¸è§æƒ…å†µæ¯”å¦‚å»¶æ—¶è¾“å‡ºæ•°ç»„æ¯ä¸ªå€¼
```js

// ä¸ªäººè®¤ä¸ºæœ€ä¼˜è§£
for (var i = 0; i< 10; i++){
 setTimeout((i) => {
  console.log(i);
 }, 1000, i);
}

// let
for (let i = 0; i< 10; i++){
  setTimeout(() => {
    console.log(i);
  }, 1000)
}
```

### æ—¶é—´åˆ‡ç‰‡æ¨¡æ‹Ÿpromise
W3Cæ€§èƒ½å·¥ä½œç»„åœ¨LongTaskè§„èŒƒä¸­å°†è¶…è¿‡50msçš„ä»»åŠ¡å®šä¹‰ä¸ºé•¿ä»»åŠ¡ï¼Œæ‰€ä»¥åˆ©ç”¨generatoræ¨¡æ‹Ÿæ—¶é—´åˆ‡ç‰‡
[å‚è€ƒ](https://mp.weixin.qq.com/s/T72mOswfA8xTyd8Wq91Iiw)

```js
function ts (gen) {
  if (typeof gen === 'function') gen = gen()
  if (!gen || typeof gen.next !== 'function') return
  return function next() {
    const res = gen.next()
    if (res.done) return
    setTimeout(next)
  }
};

btn.onclick = ts(function* () {
  someThing(); // æ‰§è¡Œäº†50æ¯«ç§’
  yield;
  otherThing(); // æ‰§è¡Œäº†50æ¯«ç§’
});

```

---

## setTimeout
- [è®¡æ—¶å™¨åŸç†](https://segmentfault.com/a/1190000002633108)
- [å¹¶å‘æ¨¡å‹](./å¹¶å‘æ¨¡å‹-event_loop.md#javascriptå¹¶å‘æ¨¡å‹)
![è®¡æ—¶å™¨åŸç†](./è®¡æ—¶å™¨åŸç†.png)

### è¦ç‚¹
- setTimeoutå±äºæµè§ˆå™¨APIï¼Œç”±æµè§ˆå™¨ç›´æ¥è¿è¡Œ
- å•çº¿ç¨‹å¯¼è‡´å‰é¢çš„ä»£ç ä¼šé˜»å¡ä¹‹åçš„ä»£ç ï¼Œ
  åŒ…æ‹¬å¼‚æ­¥äº‹ä»¶çš„æ‰§è¡Œï¼ˆclickï¼Œè®¡æ—¶å™¨ï¼ŒXMLHttpRequestï¼‰
- å¼‚æ­¥äº‹ä»¶çš„å›è°ƒå°†æ’åœ¨å½“å‰é˜Ÿåˆ—æœ€åæ‰§è¡Œï¼ˆä¸åŒæµè§ˆå™¨å¯èƒ½æœ‰å·®å¼‚ï¼‰
- è®¡æ—¶å™¨åœ¨ä»£ç æ‰§è¡Œå‰å·²å¼€å§‹è®¡æ—¶
- è®¡æ—¶å™¨çš„å›è°ƒä¸ä¼šç«‹å³æ‰§è¡Œï¼Œåœ¨çº¿ç¨‹å¯ç”¨æ—¶æ‰§è¡Œï¼ˆæ‰€ä»¥ä¼šåœ¨è‡³å°‘xxæ¯«ç§’åæ‰§è¡Œï¼‰

### setIntervalå’ŒsetTimeout
- intervalä¸èƒ½ä¿è¯ç²¾ç¡®çš„è®¡æ—¶
- timeoutèƒ½ä¿è¯è‡³å°‘xxmsåæ‰§è¡Œ

```js
// setTimeoutèƒ½ä¿è¯è‡³å°‘10æ¯«ç§’åæ‰§è¡Œcodeï¼Œ
// setIntervalä¸å…³å¿ƒå½“å‰å›è°ƒæ˜¯å¦æ‰§è¡Œå®Œï¼Œ
// éƒ½ä¼šæ‰§è¡Œä¸‹ä¸ªå›è°ƒï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°è¿ç»­è§¦å‘
setTimeout(function(){
  /* Some long block of code... */
  setTimeout(arguments.callee, 10);
}, 10);
 
setInterval(function(){
  /* Some long block of code... */
}, 10);
```

### è¿”å›å€¼
setInterval å’Œ setTimeout æ‰§è¡Œç»“æœéƒ½æ˜¯ä¸€ä¸ª timeoutId/intervalId

### ä¸¾ä¾‹
```js
setTimeout(callback, 10000);
```

#### æ‰§è¡Œæ­¥éª¤
1. æµè§ˆå™¨ç›´æ¥è¿è¡Œ(å®ƒä¼šåœ¨è°ƒç”¨å †æ ˆä¸­å‡ºç°ä¸€ä¼šå„¿ï¼Œä½†ä¼šç«‹å³åˆ é™¤)
2. 10ç§’åï¼Œå°† callback ç§»å…¥ Call Queue
    ![å›è°ƒè§¦å‘å‰](./setTimeoutå›è°ƒè§¦å‘å‰.png)
3. Event Loop ä¼šæ£€æŸ¥ Call Stackï¼Œå¦‚æœæ˜¯ç©ºçš„è¯ï¼Œå°† callback ä» Call Queueç§»å…¥ Call Stack
    ![å›è°ƒè§¦å‘å](./setTimeoutå›è°ƒè§¦å‘å.png)

---

## å‡½æ•°è°ƒç”¨æ¨¡å¼
- å‡½æ•°è°ƒç”¨
  * foo.getName()
- æ–¹æ³•è°ƒç”¨
  * getName()
- .call()
- .apply()

---

## iterator
[iteratorå‰ä¸–ä»Šç”Ÿ](https://github.com/helios741/myblog/issues/35)

- å…·æœ‰`Symbol.iterator`å±æ€§ï¼Œå³æ˜¯ iterable

### åŸç”Ÿå…·å¤‡Iteratoræ¥å£çš„æ•°æ®ç»“æ„
- Array
- Map
- Set
- String
- TypedArray
- å‡½æ•°çš„ arguments å¯¹è±¡
- NodeList å¯¹è±¡
```js
var arr = [];
var iterator = arr[Symbol.iterator](); // { next () { ... } }

// åˆ›å»ºè‡ªå®šä¹‰iterator
var iterator2 = {
  [Symbol.iterator] : function () {
    return {
      next: function () {
        return {
          value: 1,
          done: true
        };
      }
    };
  }
};

var iterator3 = {
	[Symbol.iterator](){
		var arr = [1,2,3];
		var i = 0;
		return {
			next() {
				return {
					value: arr[i++],
					done: i > arr.length,
				}
			}
		};
	},
};

var iterator4 = {
  [Symbol.iterator]: function* () {
    var i = 1;
    while(i < 10) {
      yield i;
      i++;
    }
  }
};
```

---

## Storage
å¤šä¸ªtabä¸ºäº†ç»´æŒçŠ¶æ€åŒæ­¥ï¼Œå¯ä»¥ç›‘å¬Storageäº‹ä»¶
[StorageEvent](https://developer.mozilla.org/zh-CN/docs/Web/API/StorageEvent)

```js
window.addEventListener('storage', (evt) => {
  // do sth
});
```

---

## ç®­å¤´å‡½æ•°
* æœ¬èº«æ²¡æœ‰`prototype`ï¼Œä½†æ˜¯æœ‰`constructor`
* `this`æŒ‡å‘
  - ä¸èƒ½ä¿®æ”¹
  - å¤–å±‚æœ‰æ™®é€šå‡½æ•°æ—¶ï¼ŒæŒ‡å‘æ™®é€šå‡½æ•°
  - å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°æ—¶ï¼Œthis æŒ‡å‘ windowï¼ˆéä¸¥æ ¼ï¼‰æˆ–undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
* arguments
  - å¤–å±‚æœ‰æ™®é€šå‡½æ•°æ—¶ï¼Œä¸ºæ™®é€šå‡½æ•°çš„ arguments
  - å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°æ—¶ï¼Œä¼šæŠ¥æœªç”³æ˜é”™è¯¯ï¼ˆå¯ä»¥æ‰‹åŠ¨è®¾ç½®å…¨å±€çš„ arugments é¿å…æŠ¥é”™ï¼‰
* new
  
  - ä¸æ”¯æŒï¼Œis not a constructor
* new.target
  - æ™®é€šå‡½æ•°å¦‚æœé€šè¿‡ new è°ƒç”¨ï¼Œ`new.target`ä¼šè¿”å›è¯¥å‡½æ•°çš„å¼•ç”¨
  - ä¸æ”¯æŒ
* å‡½æ•°å‚æ•°é‡å‘½å
  - ```js
    function test(aa, aa) {
      // ç¬¬äºŒä¸ªaaå–å€¼ä¼šè¦†ç›–ç¬¬ä¸€ä¸ª
    }
    ```
  - ä¸æ”¯æŒï¼ŒDuplicate parameter name not allowed in this context

---

## cookie

**ä½¿ç”¨æ³¨æ„**

1. æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ
2. åŠ å¯†å’Œå®‰å…¨ä¼ è¾“æŠ€æœ¯ï¼ˆSSLï¼‰
3. åªå­˜æ”¾ä¸æ•æ„Ÿæ•°æ®
4. åˆ†æ‹…æœåŠ¡ç«¯è´Ÿæ‹…

**ç¼ºç‚¹**

1. å®¹é‡ç¼ºé™·ï¼šæ—©æœŸIEï¼Œæ¯ä¸ªdomainæœ€å¤šåªèƒ½æœ‰20æ¡cookieï¼Œæ¯ä¸ªcookieé•¿åº¦ä¸èƒ½è¶…è¿‡4KB
2. æ€§èƒ½ç¼ºé™·ï¼šç›¸åŒåŸŸåï¼Œæ— è®ºè¯·æ±‚æ˜¯å¦éœ€è¦cookieï¼Œéƒ½ä¼šå¼ºåˆ¶æºå¸¦ï¼Œäº§ç”Ÿå·¨å¤§æ€§èƒ½æµªè´¹
3. å®‰å…¨ç¼ºé™·ï¼šåœ¨httpOnly=falseçš„å‰æä¸‹ï¼Œjså¯è¯»å–

---

## æ¨¡å—åŒ–
- IIFE
- AMD/CommonJS
- CMD
- UMD
  * å…¼å®¹AMDï¼ŒCommonJS æ¨¡å—åŒ–è¯­æ³•
- webpack(require.ensure)
  * webpack 2.x ç‰ˆæœ¬ä¸­çš„ä»£ç åˆ†å‰²
- ESModule
- angular

### angular
```js
angular.module('myApp', [])
  .controller('Ctl', ['$scope', '$log', function ($scope, $log) {
  $scope.name = 'leonwgc';
  $log.log('hello,world');
}]);
```

### ESModule
- import
- export
- export default

**import**

- ç¼–è¯‘æ—¶é™æ€æ‰§è¡Œï¼ˆä¸æ”¯æŒå˜é‡ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰
- å‘½ä»¤æå‡

**export**

> ä¸€ä¸ªæ¨¡å—å¯ä»¥æœ‰å¤šä¸ªexportï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ª export defaultï¼Œexport default å¯ä»¥å’Œå¤šä¸ª export å…±å­˜

```js
// output
const a = 'valueA1';
const b = 'valueB1';
function foo() {
  console.log(`fooæ‰§è¡Œï¼Œcçš„å€¼æ˜¯${c}`);
};
export {a};
export {b};
export default { a, b, foo };

// input
import { a, b } from '...'; // { a: 'valueA1', b: 'valueB1' }

const a = require('./output.js')
console.log(a); // { a: 'valueA1', b: 'vallueB1', default: { a: 'valueA1', b: 'valueB1', foo: [Function] } }
```

### amd
- define
- require

**æ¨å´‡æå‰æ‰§è¡Œ**

```js
define("alpha", ["require", "exports", "beta"], function (require, exports, beta) {
 exports.verb = function() {
   return beta.verb();
   //Or:
   return require("beta").verb();
 }
});
```

### CommonJS
- exports
- module.exports

**exportså’Œmodule.exportsçš„å…³ç³»ç›¸å½“äºä¸‹é¢**

```js
const exports = module.exports;
```

**ç›´æ¥ç»™ module.exports èµ‹å€¼ä¼šåˆ‡æ–­ä¸¤è€…çš„å…³è”**

```js
// output
const a = 'valueA1'
const b = 'valueB1'
const c = 'valueC1'
// è¿™é‡Œç›´æ¥ç»™ module.exports é‡æ–°èµ‹å€¼äº†
module.exports = { c }
// è¿™é‡Œçš„ `exports.b = b` ä¼šå¤±æ•ˆ
exports.b = b
module.exports.a = a

// input
const obj = require('./output.js')
console.log(obj); //=>{ c: 'valueC1', a: 'valueA1' }
```

#### cjså®ç°esmodule
```js
Object.defineProperty(exports, '__esModule', {
  value: true,
});

exports.default = function() {
  // ...
};

exports.xxx = 'xxx';
```

### cmd

**æ¨å´‡å»¶è¿Ÿæ‰§è¡Œ**

```js
define(function(require, exports) {

  // è·å–æ¨¡å— a çš„æ¥å£
  var a = require('./a');

  // è°ƒç”¨æ¨¡å— a çš„æ–¹æ³•
  a.doSomething();

});
```

### æ€»ç»“
- requireï¼Œexportsï¼Œmodule.exportså±äºAMDè§„èŒƒï¼Œ
  importï¼Œexportï¼Œexport defaultå±äºES6è§„èŒƒ
- requireæ”¯æŒåŠ¨æ€å¯¼å…¥ï¼ŒåŠ¨æ€åŒ¹é…è·¯å¾„ï¼Œimportå¯¹è¿™ä¸¤è€…éƒ½ä¸æ”¯æŒ
- requireæ˜¯è¿è¡Œæ—¶è°ƒç”¨ï¼Œimportæ˜¯ç¼–è¯‘æ—¶è°ƒç”¨
- requireæ˜¯èµ‹å€¼è¿‡ç¨‹ï¼Œimportæ˜¯è§£æ„è¿‡ç¨‹
- å¯¹äºexportå’Œexport default ä¸åŒçš„ä½¿ç”¨æ–¹å¼ï¼Œ
  importå°±è¦é‡‡å–ä¸åŒçš„å¼•ç”¨æ–¹å¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦å­˜åœ¨{},
  exportå¯¼å‡ºçš„ï¼Œimportå¯¼å…¥éœ€è¦{},å¯¼å…¥å’Œå¯¼å‡ºä¸€ä¸€å¯¹åº”,
  export defaulté»˜è®¤å¯¼å‡ºçš„ï¼Œimportå¯¼å…¥ä¸éœ€è¦{}
- exportsæ˜¯module.exportsä¸€ç§ç®€å†™å½¢å¼ï¼Œä¸èƒ½ç›´æ¥ç»™exportsèµ‹å€¼
- å½“ç›´æ¥ç»™module.exportsèµ‹å€¼æ—¶ï¼Œexportsä¼šå¤±æ•ˆ
- amdå’ŒcmdåŒºåˆ«[å‚è€ƒ](https://www.zhihu.com/question/20351507)

---

## null

### ç±»å‹æ ‡ç­¾
- 000å¼€å¤´: å¯¹è±¡ï¼Œç”±äºnullå…¨æ˜¯0ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯å¯¹è±¡ã€‚æ•°æ®æ˜¯å¯¹å¯¹è±¡çš„å¼•ç”¨ã€‚
- 001å¼€å¤´: æ•´å‹ã€‚æ•°æ®æ˜¯31ä½å¸¦ç¬¦å·æ•´æ•°ã€‚
- 010å¼€å¤´: æµ®ç‚¹å‹ã€‚æ•°æ®æ˜¯å¯¹æµ®ç‚¹æ•°æ®çš„å¼•ç”¨ã€‚
- 100å¼€å¤´: å­—ç¬¦ã€‚ æ•°æ®æ˜¯å¯¹å­—ç¬¦ä¸²ç±»å‹çš„å¼•ç”¨
- 110å¼€å¤´: boolean

```c++
JS_PUBLIC_API(JSType)

    JS_TypeOfValue(JSContext *cx, jsval v)

    {

        JSType type = JSTYPE_VOID;

        JSObject *obj;

        JSObjectOps *ops;

        JSClass *clasp;

        CHECK_REQUEST(cx);

        if (JSVAL_IS_VOID(v)) { // (1)

            type = JSTYPE_VOID;

        } else if (JSVAL_IS_OBJECT(v)) { // (2)

            obj = JSVAL_TO_OBJECT(v);

            if (obj &&

                (ops = obj->map->ops,

                 ops == &js_ObjectOps

                 ? (clasp = OBJ_GET_CLASS(cx, obj),

                    clasp->call || clasp == &js_FunctionClass) // (3,4)

                 : ops->call != 0)) { // (3)

                type = JSTYPE_FUNCTION;

            } else {

                type = JSTYPE_OBJECT;

            }

        } else if (JSVAL_IS_NUMBER(v)) {

            type = JSTYPE_NUMBER;

        } else if (JSVAL_IS_STRING(v)) {

            type = JSTYPE_STRING;

        } else if (JSVAL_IS_BOOLEAN(v)) {

            type = JSTYPE_BOOLEAN;

        }

        return type;

    }
```

---

## åæ¨¡å¼
- åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­å®šä¹‰å¤§é‡çš„å˜é‡æ±¡æŸ“å…¨å±€å‘½åç©ºé—´ã€‚
- å‘setTimeoutæˆ–setIntervalä¼ é€’å­—ç¬¦ä¸²ï¼Œæ— æ„ä¸­è§¦å‘eval( )çš„å†…éƒ¨ä½¿ç”¨ã€‚
- ä¿®æ”¹Objectç±»çš„åŸå‹
- ä»¥å†…è”å½¢å¼ä½¿ç”¨Javascriptï¼Œå®ƒæ˜¯ä¸å¯æ”¹å˜çš„ã€‚
- åœ¨ä½¿ç”¨document.createElementç­‰åŸç”ŸDOMæ–¹æ³•æ›´é€‚åˆçš„æƒ…å†µä¸‹ä½¿ç”¨document.write

---

## Array

### åˆ¤æ–­æ•°ç»„
- Array.isArray
- xxx.constructor === Array
- Object.prototype.toString.call(xxx) === '[object Array]'
- xxx instanceof Array

### å»é‡

- Setæ•°ç»„å»é‡
  ```js
  let arr = [1, 1, 2, 2, 3, 3];
  let deduped = [...new Set(arr)];
  ```
- åŒé‡éå†
- sort() + ç›¸é‚»å…ƒç´ å»é‡
- Object
- æ–°æ•°ç»„ + indexOf === -1
- indexOf !== lastIndexOf

### å­—ç¬¦ä¸²è½¬æ•°ç»„
```js
[...`${str}`]
```

### æ‰å¹³åŒ–1å±‚æ•°ç»„ flatten(array, 1)
```js
const arr = [11, [22, 33], [44, 55], 66];
const flatArr = [].concat(...arr);
```

### slice(start, end)
- åš xxx += array.length å¤„ç†
- åš Math.floor(Math.abs(xxxx)) å¤„ç†

### æŒ‡å®šä¸Šä¸‹æ–‡ç¯å¢ƒ
```js
const arr = [11, [22, 33], [44, 55], 66];
arr.forEach(function() {
  console.log(this); // Object { test: 'test' }
}, {
  test: 'test',
});
```

### Array.prototype.filterAsync
```js
Array.prototype.filterAsync = function(predicate) {
	return Promise.all(this.map(it => predicate(it)))
		.then((result) => {
			return this.filter((item, idx) => {
				return result[idx];
			});
		});
};
```

---

## é€’å½’

### å°¾é€’å½’
å¦å¤–ä¸€ç§å½¢å¼
```js
function trampoline( res ) {
  while (typeof res == "function") {
    res = res();
  }
  return res;
}

var foo = (function(){
  function _foo(acc,x) {
    if (x <= 1) return acc;
    return function partial(){
      return _foo( (x / 2) + acc, x - 1 );
    };
  }

  return function(x) {
    return trampoline( _foo( 1, x ) );
  };
})();
```

- - -

## å…¶ä»–
- åœ¨ ES6 ä¸­ï¼Œå¦‚æœå‚æ•°è¢«çœç•¥æˆ–è€…å€¼ä¸º undefinedï¼Œåˆ™å–è¯¥å‚æ•°çš„é»˜è®¤å€¼
- å‡½æ•°å£°æ˜ä¸å¯ä»¥çœç•¥å‡½æ•°å
- æ§åˆ¶åè½¬æ˜¯æ€æƒ³ï¼Œä¾èµ–æ³¨å…¥æ˜¯å…·ä½“å®ç°
  
  * ä¾èµ–æ³¨å…¥ï¼šå®ä¾‹åœ¨å¤–éƒ¨åˆå§‹åŒ–åä¼ å…¥æ–¹æ³•ï¼Œè€Œä¸æ˜¯åœ¨æ–¹æ³•é‡Œåˆå§‹åŒ–
- è®¾ç½®Errorçš„stackå±‚æ•°ï¼šError.stackTraceLimit = Infinity
- æ–æ³¢é‚£å¥‘æ•°ï¼šfor (var f = 1; number > 1; f *= number--)
- [å¤åˆ¶ç²˜è´´](https://mp.weixin.qq.com/s/2SFPhRVbbtMz3PatKTPF8w)
- [dockeræ“ä½œ](https://mp.weixin.qq.com/s/McViifQcoGhI6M-n1iCXfw)
- [ç£ç›˜è¯»å†™å’Œæ•°æ®åº“è¯»å†™æ•ˆç‡å¯¹æ¯”](https://blog.csdn.net/xiaofei0859/article/details/51147849)
  
  * ä¸€æ¬¡è¯»å–çš„å†…å®¹è¶Šå¤§ï¼Œç›´æ¥è¯»æ–‡ä»¶çš„ä¼˜åŠ¿ä¼šæ›´æ˜æ˜¾
- åç«¯uuidæ”¾é‡ç®—æ³•
  * (Math.abs(uuid) & 0x7fffffff) % 10 < percent
  * 0x7fffffffæ˜¯inté‡Œçš„æœ€å¤§å€¼ï¼Œè¿™é‡Œèµ·è¾¹ç•Œä¿æŠ¤ä½œç”¨
- [cmdåˆ¶è¡¨ç¬¦å¤§å…¨](http://www.fhdq.net/ts/49.html)
- ifä½¿ç”¨switch...caseæ›¿ä»£
  ```js
  const num = 1;
  switch(true) {
    case isNaN(num):
      // TODO
      break;
    case num > 0:
      // TODO
      break;
  }
  ```
- encodeURIComponentæ¯”encodeURIå¤šè½¬ä¹‰
  
  * ; , / ? : @ & = + $
- æµè§ˆå™¨æŒ‰éœ€åŠ è½½è„šæœ¬
  ```html
  <!-- ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸è¯†åˆ«nomoduleã€type="module"ï¼Œæ‰€ä»¥éƒ½ä¼šåŠ è½½ -->
  <!-- é«˜ç‰ˆæœ¬æµè§ˆå™¨åªä¼šåŠ è½½type="module" -->
  <!-- scripté»˜è®¤éƒ½æ˜¯type="text/javascript"ï¼Œæ‰€ä»¥æ²¡æ³¨æ˜typeä¹Ÿæ²¡å…³ç³» -->
  <script nomodule src="./src/es6.polyfill.js"></script>
  <script type="module" src="./src/es6.js"></script>
  ```
- targetå’ŒcurrentTarget
  * `target`è¿”å›è§¦å‘äº‹ä»¶çš„å…ƒç´ 
  * `currentTarget`è¿”å›ç»‘å®šäº‹ä»¶çš„å…ƒç´ 

### localstorageé™åˆ¶
pcç«¯ï¼š5-10Mï¼Œç§»åŠ¨ç«¯ï¼š2.5M

### ç±»å‹è¯­è¨€
- é™æ€ç±»å‹è¯­è¨€ï¼šåœ¨ç¼–è¯‘æ—¶æœŸå°±æ£€æŸ¥æ•°æ®ç±»å‹çš„ï¼Œæ‰€ä»¥å¿…é¡»åœ¨å£°æ˜å˜é‡çš„æ—¶å€™æŒ‡å®šæ•°æ®ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘ä¼šä¸é€šè¿‡
- å¼ºç±»å‹è¯­è¨€ï¼šå˜é‡çš„æ•°æ®ç±»å‹ä¸€æ—¦ç¡®å®šä¸‹æ¥ï¼Œå°±ä¸èƒ½æ”¹å˜äº†ï¼Œé™¤éç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢

### eval
- fast pathå’Œslow pathï¼Œevalè¿è¡Œäºslow pathï¼Œè§£æé€Ÿåº¦æ…¢10å€
- åšä»£ç æ··æ·†å‹ç¼©æ—¶å®¹æ˜“æŠ¥é”™
- éš¾ä»¥åšä¼˜åŒ–
- ä¸æ–¹ä¾¿è°ƒè¯•

### èµ‹å€¼nullå’Œundefined
null
- å…¨å±€å˜é‡ï¼šå°†è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆå¯¹è±¡ä»¥åŠå€¼æ¸…ç©º
- å¯¹è±¡å±æ€§ï¼šç»™è¿™ä¸ªå±æ€§åˆ†é…äº†ä¸€å—ç©ºçš„å†…å­˜ï¼Œåƒåœ¾å›æ”¶ä¼šå›æ”¶null

undefined
- å°†è¿™ä¸ªå¯¹è±¡çš„å€¼æ¸…ç©ºï¼Œå¯¹è±¡ä¾æ—§å­˜åœ¨

### å˜é‡å£°æ˜
varå£°æ˜åœ¨å…¨å±€ä½œç”¨åŸŸ

let/constå£°æ˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œç”±{}äº§ç”Ÿ

---

## ç»§æ‰¿

![ç»§æ‰¿](ç»§æ‰¿.png)

### åŸºæœ¬æ¦‚å¿µ
```js
function F() {}
var f = new F;

F.prototype.constructor ===  F;
F.__proto__ === Function.prototype;
Function.prototype.__proto__ === Object.prototype;
Object.prototype.__proto__ === null;

f.__proto__ === F.prototype;
F.prototype.__proto__ === Object.prototype;
Object.prototype.__proto__ === nulll;
```

### es6çš„ç»§æ‰¿
```js
class Parent {
  constructor(name) {
    this.name = name;
  }

  static sayHello() {
    console.log('hello');
  }

  sayName() {
    console.log(this.name);
  }
}

class Child extends Parent {
  constructor(name, age) {
    super(name);
    this.age = age;
  }

  sayAge() {
    console.log(this.age);
  }
}
```

### es5çš„ç»§æ‰¿
```js
function Parent(name) {
  this.name = name;
};

Parent.sayHello = function() {
  console.log('hello');
};

Parent.prototype.sayName = function() {
  console.log(this.name);
};

function Child(name, age) {
  Parent.call(this, name);
  this.age = age;
};

Child.prototype = Object.create(Parent.prototype, {
  constructor: {
    value: Child,
    writable: true,
    configurable: true,
  },
});

Child.__proto__ = Parent;

// ç›¸å½“äºChild.__proto__ = Parent;
// é™æ€æ–¹æ³•ä¹Ÿä¼šèµ‹äºˆæ–°function
Object.setPrototypeOf(Child, Parent);
Child.prototype.sayAge = function() {
  console.log(this.age);
};

var parent = new Parent('Parent');
var child = new Child('Child', 8);

console.log(parent);
console.log(child);

Parent.sayHello();
Child.sayHello();

parent.sayName();
child.sayName();
child.sayAge();

console.log(child.__proto__ === Child.prototype);
console.log(Child.prototype.__proto__ === Parent.prototype);
console.log(Parent.prototype.__proto__ === Object.prototype);
```

### webpackçš„ç»§æ‰¿
```js
function _classCallCheck(instance, Klass) {
  if (!(instance instanceof Klass)) {
    throw new Error('Cannot call a class as a function');
  }
};

function _defineProperties(target, props) {
  for (var i = 0, len = props.length; i < len; i += 1) {
    const descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ('value' in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
};

function _inherit(Child, Parent) {
  Child.prototype = Object.create(Parent.prototype, {
    constructor: {
      value: Child,
      writable: true,
      configurable: true,
    },
  });
  Object.setPrototypeOf(Child, Parent);
};

function _createClass(Klass, protoProps, staticProps) {
  if (protoProps) {
    _defineProperties(Klass.prototype, protoProps);
  }

  if (staticProps) {
    _defineProperties(Klass, staticProps);
  }
};

var Parent = (function() {
  function Parent(name) {
    _classCallCheck(this, Parent);
    this.name = name;
  }

  _createClass(Parent, [{
    key: 'sayName',
    value: function sayName() {
      console.log(this.name);
    }
  }], [{
    key: 'sayHello',
    value: function sayHello() {
      console.log('hello');
    }
  }]);
  return Parent;
} ());

var Child = (function(_Parent) {
  _inherit(Child, _Parent);
  function Child() {
    // ...
    // _possibleConstructorReturn
  };
} (Parent));
```

---

## æ·±æ‹·è´
å®Œæ•´æ€è·¯å¯[å‚è€ƒ](../fe-interview/src/æ·±æ‹·è´.md)

### ä¸è€ƒè™‘symbolçš„æƒ…å†µ
```js
const isObject = val => val && typeof val === 'object';
const has = (list = [], child) => {
  for (let item of list) {
    const [ source, target ] = item;
    if (source === child) {
      return target;
    }
  }
};
const deepClone = (source, uniqList = []) => {
  if (!isObject(source)) return source;
  if (source instanceof RegExp) return new RegExp(source);
  if (source instanceof Date) return new Date(source);
  let target = has(uniqList, source);
  if (!target) {
    target = Array.isArray(source) ? [] : {};
    for (let key in source) {
      const ssValue = source[key];
      if (isObject(ssValue)) {
        target[key] = deepClone(ssValue, uniqList);
        uniqList.push([ssValue, target[key]]);
      } else {
        target[key] = ssValue;
      }
    }
  }
  return target;  
};
```

### è€ƒè™‘symbolçš„æƒ…å†µ
```js
// æ–¹å¼1
const deepClone = (source, uniqList = []) => {
  if (!isObject(source)) return source;
  let target = has(uniqList, source);
  if (!target) {
    target = Array.isArray(source) ? [] : {};
    const symbolKeys = Object.getOwnPropertySymbols(source);

    for (let sKey of symbolKeys) {
      const symbolValue = source[sKey];
      if (isObject(symbolValue)) {
        target[sKey] = deepClone(symbolValue, uniqList);
      } else {
        target[sKey] = symbolValue;
      }
    }

    for (let key in source) {
      const ssValue = source[key];
      if (source.hasOwnProperty(key) && isObject(ssValue)) {
        target[key] = deepClone(ssValue, uniqList);
        uniqList.push([ssValue, target[key]]);
      } else {
        target[key] = ssValue;
      }
    }
  }
  return target;  
};

// æ–¹å¼2 - es6
const deepClone = (source, uniqMap = new WeakMap()) => {
  if (!isObject(source)) return source;
  if (uniqMap.has(source)) return uniqMap.get(source);
  let target = Array.isArray(source) ? [ ...source ] : { ...source };
  uniqMap.set(source, target);
  Reflect.ownKeys(target).forEach((key) => {
    const ssValue = source[key];
    if (isObject(ssValue)) {
      target[key] = deepClone(ssValue, uniqMap);
    } else {
      target[key] = ssValue;
    }
  });
  return target;
};
```

### åº”å¯¹çˆ†æ ˆé—®é¢˜
```js
const deepClone = (source) => {
  const root = {};

    // æ ˆ
    const loopList = [
        {
            parent: root,
            key: undefined,
            data: x,
        }
    ];

    while(loopList.length) {
        // æ·±åº¦ä¼˜å…ˆ
        const node = loopList.pop();
        const parent = node.parent;
        const key = node.key;
        const data = node.data;

        // åˆå§‹åŒ–èµ‹å€¼ç›®æ ‡ï¼Œkeyä¸ºundefinedåˆ™æ‹·è´åˆ°çˆ¶å…ƒç´ ï¼Œå¦åˆ™æ‹·è´åˆ°å­å…ƒç´ 
        let res = parent;
        if (typeof key !== 'undefined') {
            res = parent[key] = {};
        }

        for(let k in data) {
            if (data.hasOwnProperty(k)) {
                if (typeof data[k] === 'object') {
                    // ä¸‹ä¸€æ¬¡å¾ªç¯
                    loopList.push({
                        parent: res,
                        key: k,
                        data: data[k],
                    });
                } else {
                    res[k] = data[k];
                }
            }
        }
    }
    return root;
};
```

---

## å­—èŠ‚
[è®¡ç®—å­—ç¬¦ä¸²æ‰€å å­—èŠ‚æ•°](http://www.cnblogs.com/1175429393wljblog/p/4562736.html)

### utf8å’Œutf16
* utf8 - å˜é•¿å­—ç¬¦ç¼–ç 
  - 1å­—èŠ‚ï¼š000000 - 00007Fï¼ˆ128ä¸ªï¼‰
  - 2å­—èŠ‚ï¼š000080 - 0007FFï¼ˆ1920ä¸ªï¼‰
  - 3å­—èŠ‚ï¼š000800 - 00D7FF å’Œ 00E000 - 00FFFFï¼ˆ61440ä¸ªï¼‰
    æ³¨ï¼šD800-DFFF ä¸­ä¸å­˜åœ¨ä»»ä½•å­—ç¬¦
  - 4å­—èŠ‚ï¼š010000 - 10FFFFï¼ˆ1048576ä¸ªï¼‰
* utf16 - å®šé•¿å­—ç¬¦ç¼–ç ï¼ˆå…¶å®ä¹Ÿç®—å˜é•¿å­—ç¬¦ï¼‰
  - 2å­—èŠ‚ï¼š000000 â€“ 00FFFF
  - 4å­—èŠ‚ï¼š010000 â€“ 10FFFF

### æ‹“å±•
Javaç®€å•æ•°æ®ç±»å‹ä¸­æ‰€å å­—ç¬¦ä¸å®šï¼š
- floatå ç”¨ 4 å­—èŠ‚
- double 8 å­—èŠ‚
- byte 1å­—èŠ‚ -128åˆ°127
- short 2 å­—èŠ‚
- int 4 å­—èŠ‚
- long 8 å­—èŠ‚

---

## èŠ‚æµvsé˜²æŠ–
**èŠ‚æµ(throttle)**

æ¯éš”ä¸€æ®µæ—¶é—´åæ‰§è¡Œä¸€æ¬¡

**é˜²æŠ– (debounce)**

å°†å¤šæ¬¡é«˜é¢‘æ“ä½œä¼˜åŒ–ä¸ºåªåœ¨æœ€åä¸€æ¬¡æ‰§è¡Œ

---

## æ–‡ä»¶ä¸‹è½½

### ç”Ÿæˆä¸‹è½½å­—ç¬¦ä¸²æ–‡ä»¶
```html
<!-- è¦è®¾ç½®download -->
<a download="xxx.json" id="mylink" href="#">click download</a>
```
```js
const debug = {hello: "world"};
const blob = new Blob([JSON.stringify(debug, null, 2)], {type : 'application/json'});

// ç”Ÿæˆblobé“¾æ¥
const objectURL = URL.createObjectURL(blob);
const link = document.getElementById('mylink');
link.setAttribute('href', objectURL);

// ä¸ºé¿å…å†…å­˜è¿‡åº¦å ç”¨ï¼Œåœ¨å®‰å…¨æ—¶æœºåˆ é™¤url
URL.revokeObjectURL(objectURL)
```

```js
// json
function downloadJson(fileName, json) {
  const jsonStr = (json instanceof Object) ? JSON.stringify(json, null, 4) : json;
  
  const url = window.URL || window.webkitURL || window;
  const blob = new Blob([jsonStr]);
  const saveLink = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
  saveLink.href = url.createObjectURL(blob);
  saveLink.download = fileName;
  saveLink.click();
}
```

### è¯»å–æ–‡ä»¶
```js
const reader = new FileReader();
const debug = {hello: "world"};
const blob = new Blob([JSON.stringify(debug, null, 2)], {type : 'application/json'});

reader.onloadend = function onload() {
  console.log(reader.result);
};
reader.readAsDataURL(blob);
reader.readAsText(blob);
```

---

## Element

### åŸå‹æ–¹æ³•

#### matches
>
> Element.prototype.matches(selectorString);
>
> åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ¹é…æŒ‡å®šé€‰æ‹©å™¨
>
> åŒmatchesSelector
>

#### closest
>
> Element.prototype.closest(selectors);
>
> è¿”å›æ»¡è¶³æŒ‡å®šé€‰æ‹©å™¨çš„æœ€è¿‘ç¥–å…ˆå…ƒç´ 
>
> éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒ`matches`ï¼Œä½†ä¸æ”¯æŒ`closest`
>

#### insertAdjacentHTML
>
> Element.insertAdjacentHTML(direction, el || elHTML);
>
> directionå¯ä»¥ä¸ºä»¥ä¸‹å››ä¸ªå€¼ï¼š
>   1. beforebegin: å…ƒç´ ä¹‹å‰
>
>   2. afterbegin: åœ¨å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ä¹‹å‰
>
>   3. beforeend: åœ¨å…ƒç´ çš„æœ€åä¸€ä¸ªå­å…ƒç´ ä¹‹å
>
>   4. afterend: å…ƒç´ ä¹‹å

```js
// æ’å…¥
const p = document.querySelector('p');
p.insertAdjacentHTML('beforebegin', '<a>hello world</a>');

// ç§»åŠ¨å…ƒç´ h2
const h1 = document.querySelector('h1');
const h2 = document.querySelector('h2');
h1.insertAdjacentElement('afterend', h2);
```





