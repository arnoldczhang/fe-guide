# åŸºæœ¬å¸¸è¯†

## ç›®å½•
<details>
<summary>å±•å¼€æ›´å¤š</summary>

* [`Symbol`](#Symbol)
* [`new`](#new)
* [`String`](#String)
* [`JSON`](#JSON)
* [`Object`](#Object)
* [`Number`](#Number)
* [`this`](#this)
* [`ajaxç­‰è¯·æ±‚æ–¹å¼`](#å‰ç«¯è¯·æ±‚æ–¹å¼)
* [`Array`](#Array)
* [`Promise`](#Promise)
* [`iterator`](#iterator)
* [`null`](#null)
* [`regexp`](#regexp)
* [`cookie`](#cookie)
* [`æ¨¡å—åŒ–`](#æ¨¡å—åŒ–)
* [`å…¶ä»–`](#å…¶ä»–)
* [`ç»§æ‰¿`](#ç»§æ‰¿)
* [`æ·±æ‹·è´`](#æ·±æ‹·è´)
* [`åæ¨¡å¼`](#åæ¨¡å¼)
* [`é€’å½’`](#é€’å½’)
* [`å­—èŠ‚`](#å­—èŠ‚)
* [`èŠ‚æµvsé˜²æŠ–`](#èŠ‚æµvsé˜²æŠ–)
* [`æ–‡ä»¶ä¸‹è½½`](#æ–‡ä»¶ä¸‹è½½)

</details>

## String

### indexOf VS search
- search:é»˜è®¤å¤„ç†æ­£åˆ™ï¼Œæ¯”å¦‚'aaa\n'.search('.')ï¼Œæ˜¯0ï¼Œå› ä¸º/./
- indexOf:å¤„ç†å­—ç¬¦ä¸²ï¼ŒåŒæ˜¯å­—ç¬¦ä¸²ï¼Œç•¥å¿«

### valueOf VS toString
- ç±»å‹è½¬æ¢æ—¶ï¼Œä¼˜å…ˆè°ƒç”¨valueOf()æ–¹æ³•ï¼Œç„¶åé€šè¿‡toStringæŠ½è±¡æ“ä½œå°†è¿”å›å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²
```js
function Foo(n) {
  this.number = n;
}

Foo.prototype.valueOf = function() {
  return 123;
};

var obj = new Foo;
obj + 1; // æ­¤æ—¶è¾“å‡º124

Foo.prototype.valueOf = function() {
  return 321;
};

obj + 1; // æ­¤æ—¶è¾“å‡º322
```

### +
- æ“ä½œæ•°æ˜¯stringï¼Œåšæ‹¼æ¥ï¼Œå¦åˆ™åšç›¸åŠ ï¼›
- æ“ä½œæ•°æ˜¯objectï¼ŒåštoPrimitiveï¼ˆvalueOfæˆ–toStringï¼‰ï¼Œå†æŒ‰ï¼ˆ1ï¼‰åˆ¤æ–­ï¼›

### == VS ===
-  == å…è®¸åœ¨ç›¸ç­‰æ¯”è¾ƒä¸­è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè€Œ === ä¸å…è®¸ã€‚

### å­—ç¬¦ä¸²å’Œæ•°å­—ä¹‹é—´çš„ç›¸ç­‰æ¯”è¾ƒ
- å¦‚æœ Type(x) æ˜¯æ•°å­—ï¼ŒType(y) æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› x == ToNumber(y) çš„ç»“æœã€‚ 
- å¦‚æœ Type(x) æ˜¯å­—ç¬¦ä¸²ï¼ŒType(y) æ˜¯æ•°å­—ï¼Œåˆ™è¿”å› ToNumber(x) == y çš„ç»“æœã€‚
- å¦åˆ™è¿”å› ToBoolean(x) == ToBoolean(y)çš„ç»“æœã€‚

### å¯¹è±¡å’Œéå¯¹è±¡ä¹‹é—´çš„ç›¸ç­‰æ¯”è¾ƒ
- ToPromitiveé»˜è®¤è½¬æ•°å­—ï¼›
- å¦‚æœ Type(x) æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼ŒType(y) æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å› x == ToPrimitive(y) çš„ç»“æœï¼›
- å¦‚æœ Type(x) æ˜¯å¯¹è±¡ï¼ŒType(y) æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œåˆ™è¿”å› ToPromitive(x) == y çš„ç»“æœï¼›

---

## regexp
[å¸¸ç”¨è¯­è¨€æ­£åˆ™ç‰¹æ€§ä¸€è§ˆ](https://github.com/yurii-yu/regexs/blob/master/feature_overview.md)

### ç‰¹æ®Šç”¨æ³•
**åŒ¹é…æ‰€æœ‰**

[^]

**éè´ªå©ª**
\w+?

### è½¬ä¹‰å­—ç¬¦
- * . ? + $ ^ [ ] ( ) { } | \ /

### exec VS match
- execä¼šå¸¦lastIndexï¼Œmatchä¸ä¼š
ä¾‹ï¼šæ­£åˆ™é€’å½’
```js
var str = 'abc';
var reg = /\w/g;
var result;
while (result = reg.exec(str)) {
  console.log(result);
}
```

---

## Number

### 0.1 + 0.2 !== 0.3
- jsä¸­çš„æ•°å­—éƒ½æ˜¯ç”¨IEEE 754 æ ‡å‡†çš„åŒç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤º
- IEEEåŒç²¾åº¦æ ¼å¼å…·æœ‰53 ä½æœ‰æ•ˆæ•°å­—ç²¾åº¦(åŒ…å«1ä½ç¬¦å·ä½)ï¼Œå¹¶æ€»å…±å ç”¨64 ä½
- è®¡ç®—æœºä¸­å­˜å‚¨å°æ•°æ˜¯å…ˆè½¬æ¢æˆäºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨
- Number.MAX_SAFE_INTEGER 2çš„53æ¬¡æ–¹ - 1
ä¾‹ï¼š
```js
// 9007199254740991
// 
// (0.1)10 => (0.00011001100110011001(1001å¾ªç¯)...)2
// (0.2)10 => (0.00110011001100110011(0011å¾ªç¯)...)2
```

## æ³›ç”¨å‹isObject
- ç±»ä¼¼new String('aa')ä»ä¸ç®—object
```js
function isProxyable(value) {
  if (!value) return false;
  if (typeof value !== "object") return false;
  if (Array.isArray(value)) return true;
  const proto = Object.getPrototypeOf(value);
  return proto === null || proto === Object.prototype;
};
```

---

## å‰ç«¯è¯·æ±‚æ–¹å¼
[å‰ç«¯æ‰€æœ‰ç½‘ç»œè¯·æ±‚æ–¹å¼](https://mp.weixin.qq.com/s/LKcEylaxb21_GeCXoGZ8fA)

### å˜è¿
- formè¡¨å•ã€ifreamã€åˆ·æ–°é¡µé¢
- Ajax - å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„å¼€å±±é¼»ç¥–
- jQuery - ä¸€ä¸ªæ—¶ä»£
- fetch - Ajaxçš„æ›¿ä»£è€…
- axiosã€requestç­‰ä¼—å¤šå¼€æºåº“

### readystate
- 0: è¯·æ±‚æœªåˆå§‹åŒ–ï¼ˆè¿˜æ²¡æœ‰è°ƒç”¨ open()ï¼‰ã€‚
- 1: è¯·æ±‚å·²ç»å»ºç«‹ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å‘é€ï¼ˆè¿˜æ²¡æœ‰è°ƒç”¨ send()ï¼‰ã€‚
- 2: è¯·æ±‚å·²å‘é€ï¼Œæ­£åœ¨å¤„ç†ä¸­ï¼ˆé€šå¸¸ç°åœ¨å¯ä»¥ä»å“åº”ä¸­è·å–å†…å®¹å¤´ï¼‰ã€‚
- 3: è¯·æ±‚åœ¨å¤„ç†ä¸­ï¼›é€šå¸¸å“åº”ä¸­å·²æœ‰éƒ¨åˆ†æ•°æ®å¯ç”¨äº†ï¼Œä½†æ˜¯æœåŠ¡å™¨è¿˜æ²¡æœ‰å®Œæˆå“åº”çš„ç”Ÿæˆã€‚
- 4: å“åº”å·²å®Œæˆï¼›æ‚¨å¯ä»¥è·å–å¹¶ä½¿ç”¨æœåŠ¡å™¨çš„å“åº”äº†ã€‚

## Object.getOwnPropertyDescriptor
```js
var obj = {};
Object.defineProperty(obj, aa, {
  get() {/*...*/},
  set() {/*...*/},
});

Object.getOwnPropertyDescriptor(obj);
/*
  {
    get(){},
    set(){},
    configurable: true,
    enumerable: true,
  }
*/
```

### fetch VS XMLHttpRequest
ç›¸æ¯”XMLHttpRequestï¼Œfetchå¯å¯¹è¯·æ±‚åšæ›´å¤šæ§åˆ¶
- credentials
- mode
- cache
- redirect
- referrer
- integrity

#### credentials
æ§åˆ¶è¯·æ±‚æ˜¯å¦å¸¦ä¸Š cookie ç­‰æœºå¯†ä¿¡æ¯

fetch
- omit: è¯·æ±‚ä¸å¸¦ä»»ä½• cookie
- same-origin: åŒåŸŸè¯·æ±‚ä¼šå¸¦ä¸Š cookie
- include: æ— è®ºæ˜¯å¦è·¨åŸŸéƒ½ä¼šå¸¦ä¸Š cookie

XMLHttpRequest (withCredentials)
- true: å¤§è‡´å¯¹åº”ä¸Šé¢çš„ includeï¼ŒMDN ä¸Šæè¿°æ­¤ flag ä¸æ­¢æ§åˆ¶ cookie è¿˜æ§åˆ¶ authorization headers æˆ–è€… TLS client certificatesã€‚
- false: å¤§è‡´å¯¹åº”ä¸Šé¢çš„ omitï¼ŒMDN ä¸Šæè¿°ä¸º false æ—¶è¿˜æ§åˆ¶è·¨åŸŸè¯·æ±‚çš„ response ä¸èƒ½è®¾ç½® cookieã€‚

#### mode
è®¾ç½®è¯·æ±‚æ–¹å¼çš„é˜»æ­¢è·¨åŸŸæ ‡å¿—ä½

fetch
- same-origin
- no-cors
- cors
- navigate

## JSON

### toJSON
- å¦‚æœå¯¹è±¡ä¸­å®šä¹‰äº†toJSON() æ–¹æ³•ï¼Œstringifyä¼šé¦–å…ˆè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå†ç”¨å®ƒçš„è¿”å› å€¼æ¥è¿›è¡Œåºåˆ—åŒ–
```js
var obj = {
  toJSON() {
    return 'aaa';
  },
};
```

### æ”¯æŒçš„æ•°æ®ç±»å‹
ç”±äºJSONæ˜¯é€šç”¨æ–‡æœ¬æ ¼å¼ï¼Œå’Œè¯­è¨€æ— å…³ï¼Œæ‰€ä»¥æ— æ³•é’ˆå¯¹è¯­è¨€çš„ç‰¹å®šæ•°æ®ç±»å‹åšè½¬æ¢
- String
- Number
- Null
- Boolean

### stringify
- Boolean | Number| String ç±»å‹ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚
- undefinedã€ä»»æ„å‡½æ•°ä»¥åŠsymbolï¼Œä¼šè¢«å¿½ç•¥ï¼ˆå‡ºç°åœ¨éæ•°ç»„å¯¹è±¡çš„å±æ€§å€¼ä¸­æ—¶ï¼‰ï¼Œ
  æˆ–è€…è¢«è½¬æ¢æˆ nullï¼ˆå‡ºç°åœ¨æ•°ç»„ä¸­æ—¶ï¼‰ã€‚
- ä¸å¯æšä¸¾çš„å±æ€§ä¼šè¢«å¿½ç•¥
- å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§å€¼é€šè¿‡æŸç§é—´æ¥çš„æ–¹å¼æŒ‡å›è¯¥å¯¹è±¡æœ¬èº«ï¼Œå³å¾ªç¯å¼•ç”¨ï¼Œå±æ€§ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚

**å…¥å‚**

- input
- replacement
  * keyæ›¿æ¢æ–¹æ³•ï¼Œæ·±åº¦éå†
  * function(key, value)ï¼Œreturnå€¼ä¸ºæ›¿ä»£å€¼
- space

---

## this
- å‡½æ•°åœ¨newä¸­è°ƒç”¨(newç»‘å®š)çš„è¯ï¼Œthisç»‘å®šçš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚
```js
var bar = new foo();
```

- å‡½æ•°æ˜¯å¦é€šè¿‡callã€apply(æ˜¾å¼ç»‘å®š)æˆ–è€…ç¡¬ç»‘å®šè°ƒç”¨ï¼Œthisç»‘å®šçš„æ˜¯æŒ‡å®šçš„å¯¹è±¡ã€‚
```js
var bar = foo.call(obj2);
var bar2 = foo.apply(obj2);
var bar3 = foo.bind(obj2);
```

- å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨(éšå¼ç»‘å®š)ï¼Œthis ç»‘å®šçš„æ˜¯é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚
```js
var bar = obj1.foo();
```

- å¦‚æœéƒ½ä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨é»˜è®¤ç»‘å®šã€‚å¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ°undefinedï¼Œå¦åˆ™ç»‘å®šåˆ° å…¨å±€å¯¹è±¡ã€‚
```js
var bar = foo();
```

### thisæ˜¾å¼ç»‘å®š
```js
class MeowctComponent {
  constructor() {
    this.paw = document.getElementById('button');
  }

  meow() {
    console.info('ğŸ± on this: ', this.paw);
  }
}
const cat = new MeowctComponent();

// æ–¹å¼1ï¼šç®­å¤´å‡½æ•°
cat.paw.addEventListener('click', () => cat.meow());
// æ–¹å¼2ï¼šbind
cat.paw.addEventListener('click', cat.meow.bind(cat));
// æ–¹å¼3ï¼šç»‘å®šæ“ä½œç¬¦::ï¼ˆææ¡ˆï¼‰
cat.paw.addEventListener('click', ::cat.meow);
```

---

## new

### newå…³é”®å­—
- å‚è€ƒecma262-12.3.3
- åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å‹æ˜¯object
- é“¾æ¥åˆ°åŸå‹: obj.__proto__ = Con.prototype
(è®¾ç½®è¿™ä¸ªæ–°çš„å¯¹è±¡çš„å†…éƒ¨ã€å¯è®¿é—®æ€§å’Œ[[Prototype]]å±æ€§ä¸ºæ„é€ å‡½æ•°ï¼ˆæŒ‡prototype.construtoræ‰€æŒ‡å‘çš„æ„é€ å‡½æ•°ï¼‰ä¸­è®¾ç½®çš„)
- ç»‘å®šthis: apply
(æ‰§è¡Œ[[Construct]]ï¼Œå½“thiså…³é”®å­—è¢«æåŠçš„æ—¶å€™ï¼Œä½¿ç”¨æ–°åˆ›å»ºçš„å¯¹è±¡çš„å±æ€§)
- è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼ˆé™¤éæ„é€ æ–¹æ³•ä¸­è¿”å›çš„æ˜¯â€˜æ— åŸå‹â€™ï¼‰

### åˆ¤æ–­æ˜¯å¦æ˜¯newè°ƒç”¨
```js
class Parent {
  constructor() {
    if (new.target === Parent) {
      console.log( "Parent instantiated" );
    }
    else {
      console.log( "A child instantiated" );
    }
  }
}
```

### instanceof
å®ä¾‹çš„åŸå‹å¯¹è±¡é“¾ä¸­ï¼Œèƒ½å¦æ‰¾åˆ°è¯¥æ„é€ å‡½æ•°çš„prototypeå±æ€§æ‰€æŒ‡å‘çš„åŸå‹å¯¹è±¡

---

## Object

### åˆ›å»ºå¯¹è±¡
```js
var atom = {/* ... */};
var atom = Object.create(null);
var atom = new Foo;
var atom = Foo.call(/* ... */);
var atom = Object.setPrototypeOf(new Object, null);
```

### Object.keys
å‚è§[Object.keys](Object.keys.md)

### Object.preventExtensionsã€Object.sealã€Object.freeze
- http://www.cnblogs.com/snandy/p/5278474.html

### å¯¹è±¡åˆ é™¤ä¸éœ€è¦çš„å±æ€§
```js
const obj = {
  a: 1,
  b: 2,
  c: 3,
  d: 4,
};

const {
  a,
  b,
  ...cleanObject,
} = obj;

console.log(cleanObject);
```

### åˆå¹¶å¯¹è±¡
```js
const obj = {
  a: 1,
  b: 2,
};

const obj2 = {
  c: 3,
  d: 4,
};

const obj3 = {...obj, ...obj2};
console.log(obj3);
```

### for...ofå¯¹è±¡
```js
for (const k of Object.keys(obj)) ... // enumerable own keys
for (const [k, v] of Object.entries(obj)) ... // enumerable own [key, value]s
for (const k of Object.getOwnPropertyNames(obj)) // all own keys
for (const s of Object.getOwnPropertySymbols(obj)) // all own symbols
for (const k of Reflect.ownKeys(obj)) // all own keys (include symbols)
```

---

## Promise
[v8-promise](https://github.com/v8/v8/blob/4b9b23521e6fd42373ebbcb20ebe03bf445494f9/src/objects/promise.h)

### Promise.all

**åªè¦ä¸€ä¸ªç»“æœæ˜¯rejectå°±è¿›error**

```js
async function getFullPost() {
  return await Promise.all([
    fetch('/aa'),
    fetch('/bb')
  ]);
};

const [aa, bb] = getFullPost();
```

### Promise.prototype.cancel
```js
function CancelPromise(cb) {
  this.promise = new Promise(cb);
  this.canceled = false;
};

CancelPromise.prototype = {
  cancel() {
    this.canceled = true;
  },

  then(cb) {
    cb = (data) => {
      if (!this.canceled) {
        cb(data);
      }
    };
    return this.promise.then(cb);
  },
};

// test
const p1 = new CancelPromise((resolve, reject) => {
  setTimeout(() => {
    resolve(123);
  }, 3000);
});

setTimeout(() => {
  p1.cancel();
}, 1000);

p1.then((data) => {
  console.log(data);
});
```

### Promise.race

**ä¾‹1**
- åŠ è½½å¤šå¼ å›¾ç‰‡ï¼Œä¼˜å…ˆè¿”å›çš„å–ä¸ºç›®æ ‡å›¾ç‰‡ï¼Œä¼˜å…ˆè¿”å›çš„å¦‚æœæŠ¥é”™åˆ™ä¸å–
- è€ƒè™‘å¼‚å¸¸æƒ…å†µ

```js
// ç¬¬ä¸€ä¸ªå›¾ç‰‡
const p1 = new Promise((resolve, reject) => {
  setTimeout(() => {
    // if (/*æˆåŠŸ*/) {
    //   resolve(1);
    // } else {
    //   // ä»€ä¹ˆä¹Ÿä¸åš
    // }
  }, 1000);
});

// ç¬¬äºŒä¸ªå›¾ç‰‡
const p2 = new Promise((resolve, reject) => {
  setTimeout(() => {
    // if (/*æˆåŠŸ*/) {
    //   resolve(2);
    // } else {
    //   // ä»€ä¹ˆä¹Ÿä¸åš
    // }
  }, 2000);
});

// å…œåº•å›¾ç‰‡
const p3 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve(3);
  }, 3000);
});

Promise.race([p1, p2, p3]).then((res) => {
  console.log(res);
}).catch((err) => {
  console.log('err', err);
});
```

### async/await VS generator
- awaitä¼šç­‰å¾…åé¢ç»“æœï¼Œå†æ‰§è¡Œä¸‹é¢è¯­å¥ï¼Œå¦‚æœåœ¨å‡½æ•°å†…ï¼Œä»…å¯¹å‡½æ•°å†…è¯­å¥èµ·é˜»å¡ä½œç”¨
- asyncæ˜¯Generatorå‡½æ•°çš„è¯­æ³•ç³–ã€‚
- asyncå‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆasyncï¼Œå°†yieldæ›¿æ¢æˆawait
```js
function *foo() {
  yield 1;
  yield 2;
  yield 3;
};

var f = foo();
f.next();
// { value: 1, done: false }
// ...
```

```js
async function run() {
  async function aa() {
    return new Promise((res) => {
      setTimeout(() => { res(['a', 'b', 'c'])}, 3000);
    });
  };

  var aaRes = await aa();

  for await (const friend of aaRes) {
    console.log(friend);
  }
};
```

### setTimeout

å¸¸è§æƒ…å†µæ¯”å¦‚å»¶æ—¶è¾“å‡ºæ•°ç»„æ¯ä¸ªå€¼
```js

// ä¸ªäººè®¤ä¸ºæœ€ä¼˜è§£
for (var i = 0; i< 10; i++){
 setTimeout((i) => {
  console.log(i);
 }, 1000, i);
}

// let
for (let i = 0; i< 10; i++){
  setTimeout(() => {
    console.log(i);
  }, 1000)
}
```

---

## å‡½æ•°è°ƒç”¨æ¨¡å¼
- å‡½æ•°è°ƒç”¨
  - foo.getName()
- æ–¹æ³•è°ƒç”¨
  - getName()
- .call()
- .apply()

---

## iterator
[iteratorå‰ä¸–ä»Šç”Ÿ](https://github.com/helios741/myblog/issues/35)

- å…·æœ‰Symbol.iteratorå±æ€§ï¼Œå³æ˜¯iterable

### åŸç”Ÿå…·å¤‡Iteratoræ¥å£çš„æ•°æ®ç»“æ„
- Array
- Map
- Set
- String
- TypedArray
- å‡½æ•°çš„ arguments å¯¹è±¡
- NodeList å¯¹è±¡
```js
var arr = [];
var iterator = arr[Symbol.iterator](); // { next () { ... } }

// åˆ›å»ºè‡ªå®šä¹‰iterator
var iterator2 = {
  [Symbol.iterator] : function () {
    return {
      next: function () {
        return {
          value: 1,
          done: true
        };
      }
    };
  }
};
```

---

## cookie
ä½¿ç”¨æ³¨æ„:
1. æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ
2. åŠ å¯†å’Œå®‰å…¨ä¼ è¾“æŠ€æœ¯ï¼ˆSSLï¼‰
3. åªå­˜æ”¾ä¸æ•æ„Ÿæ•°æ®
4. åˆ†æ‹…æœåŠ¡ç«¯è´Ÿæ‹…

ç¼ºç‚¹:
1. æ—©æœŸIEï¼Œæ¯ä¸ªdomainæœ€å¤šåªèƒ½æœ‰20æ¡cookieï¼Œæ¯ä¸ªcookieé•¿åº¦ä¸èƒ½è¶…è¿‡4KB

---

## æ¨¡å—åŒ–
- IIFE
- AMD/CommonJS
- CMD
- UMD
  * å…¼å®¹AMDï¼ŒCommonJS æ¨¡å—åŒ–è¯­æ³•
- webpack(require.ensure)
  * webpack 2.x ç‰ˆæœ¬ä¸­çš„ä»£ç åˆ†å‰²
- ESModule

### ESModule
- import
- export
- export default

**import**

- ç¼–è¯‘æ—¶é™æ€æ‰§è¡Œï¼ˆä¸æ”¯æŒå˜é‡ã€æ¡ä»¶åˆ¤æ–­ç­‰ï¼‰
- å‘½ä»¤æå‡

**export**

ä¸€ä¸ªæ¨¡å—å¯ä»¥æœ‰å¤šä¸ªexportï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªexport defaultï¼Œexport defaultå¯ä»¥å’Œå¤šä¸ªexportå…±å­˜

```js
// output
const a = 'valueA1';
const b = 'valueB1';
function foo() {
  console.log(`fooæ‰§è¡Œï¼Œcçš„å€¼æ˜¯${c}`);
};
export {a};
export {b};
export default { a, b, foo };


// input
import { a, b } from '...'; // { a: 'valueA1', b: 'valueB1' }

const a = require('./output.js')
console.log(a); // { a: 'valueA1', b: 'vallueB1', default: { a: 'valueA1', b: 'valueB1', foo: [Function] } }
```

### amd/CommonJS
- require
- exports
- module.exports

exportså’Œmodule.exportsçš„å…³ç³»ç›¸å½“äºä¸‹é¢
```js
const exports = module.exports;
```

ç›´æ¥ç»™exportsèµ‹å€¼ä¼šåˆ‡æ–­exportså’Œ module.exportsçš„å…³è”
```js
// output
const a = 'valueA1'
const b = 'valueB1'
const c = 'valueC1'
module.exports = { c }
exports.b = b//å½“ç›´æ¥ç»™ module.exportsæ—¶ï¼Œexportsä¼šå¤±æ•ˆ
module.exports.a = a


// input
const obj = require('./output.js')
console.log(obj); //=>{ c: 'valueC1', a: 'valueA1' }
```

### cmd
```js
define('./index.js',function(code){
    // code å°±æ˜¯index.js è¿”å›çš„å†…å®¹
})

```

### æ€»ç»“
- requireï¼Œexportsï¼Œmodule.exportså±äºAMDè§„èŒƒï¼Œ
  importï¼Œexportï¼Œexport defaultå±äºES6è§„èŒƒ
- requireæ”¯æŒåŠ¨æ€å¯¼å…¥ï¼ŒåŠ¨æ€åŒ¹é…è·¯å¾„ï¼Œimportå¯¹è¿™ä¸¤è€…éƒ½ä¸æ”¯æŒ
- requireæ˜¯è¿è¡Œæ—¶è°ƒç”¨ï¼Œimportæ˜¯ç¼–è¯‘æ—¶è°ƒç”¨
- requireæ˜¯èµ‹å€¼è¿‡ç¨‹ï¼Œimportæ˜¯è§£æ„è¿‡ç¨‹
- å¯¹äºexportå’Œexport default ä¸åŒçš„ä½¿ç”¨æ–¹å¼ï¼Œ
  importå°±è¦é‡‡å–ä¸åŒçš„å¼•ç”¨æ–¹å¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦å­˜åœ¨{},
  exportå¯¼å‡ºçš„ï¼Œimportå¯¼å…¥éœ€è¦{},å¯¼å…¥å’Œå¯¼å‡ºä¸€ä¸€å¯¹åº”,
  export defaulté»˜è®¤å¯¼å‡ºçš„ï¼Œimportå¯¼å…¥ä¸éœ€è¦{}
- exportsæ˜¯module.exportsä¸€ç§ç®€å†™å½¢å¼ï¼Œä¸èƒ½ç›´æ¥ç»™exportsèµ‹å€¼
- å½“ç›´æ¥ç»™module.exportsèµ‹å€¼æ—¶ï¼Œexportsä¼šå¤±æ•ˆ

---

## null

### ç±»å‹æ ‡ç­¾
- 000: å¯¹è±¡ã€‚æ•°æ®æ˜¯å¯¹å¯¹è±¡çš„å¼•ç”¨ã€‚
- 001: æ•´å‹ã€‚æ•°æ®æ˜¯31ä½å¸¦ç¬¦å·æ•´æ•°ã€‚
- 010: æµ®ç‚¹å‹ã€‚æ•°æ®æ˜¯å¯¹æµ®ç‚¹æ•°æ®çš„å¼•ç”¨ã€‚
- 100: å­—ç¬¦ã€‚ æ•°æ®æ˜¯å¯¹å­—ç¬¦ä¸²ç±»å‹çš„å¼•ç”¨
- 110: boolean. æ•°æ®æ˜¯boolean.

```c++
JS_PUBLIC_API(JSType)

    JS_TypeOfValue(JSContext *cx, jsval v)

    {

        JSType type = JSTYPE_VOID;

        JSObject *obj;

        JSObjectOps *ops;

        JSClass *clasp;

        CHECK_REQUEST(cx);

        if (JSVAL_IS_VOID(v)) { // (1)

            type = JSTYPE_VOID;

        } else if (JSVAL_IS_OBJECT(v)) { // (2)

            obj = JSVAL_TO_OBJECT(v);

            if (obj &&

                (ops = obj->map->ops,

                 ops == &js_ObjectOps

                 ? (clasp = OBJ_GET_CLASS(cx, obj),

                    clasp->call || clasp == &js_FunctionClass) // (3,4)

                 : ops->call != 0)) { // (3)

                type = JSTYPE_FUNCTION;

            } else {

                type = JSTYPE_OBJECT;

            }

        } else if (JSVAL_IS_NUMBER(v)) {

            type = JSTYPE_NUMBER;

        } else if (JSVAL_IS_STRING(v)) {

            type = JSTYPE_STRING;

        } else if (JSVAL_IS_BOOLEAN(v)) {

            type = JSTYPE_BOOLEAN;

        }

        return type;

    }
```

---

## åæ¨¡å¼
- åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­å®šä¹‰å¤§é‡çš„å˜é‡æ±¡æŸ“å…¨å±€å‘½åç©ºé—´ã€‚
- å‘setTimeoutæˆ–setIntervalä¼ é€’å­—ç¬¦ä¸²ï¼Œæ— æ„ä¸­è§¦å‘eval( )çš„å†…éƒ¨ä½¿ç”¨ã€‚
- ä¿®æ”¹Objectç±»çš„åŸå‹
- ä»¥å†…è”å½¢å¼ä½¿ç”¨Javascriptï¼Œå®ƒæ˜¯ä¸å¯æ”¹å˜çš„ã€‚
- åœ¨ä½¿ç”¨document.createElementç­‰åŸç”ŸDOMæ–¹æ³•æ›´é€‚åˆçš„æƒ…å†µä¸‹ä½¿ç”¨document.write

---

## Array

### Setæ•°ç»„å»é‡
let arr = [1, 1, 2, 2, 3, 3];
let deduped = [...new Set(arr)];

### å­—ç¬¦ä¸²è½¬æ•°ç»„
```js
[...`${str}`]
```

### æ‰å¹³åŒ–1å±‚æ•°ç»„ flatten(array, 1)
```js
const arr = [11, [22, 33], [44, 55], 66];
const flatArr = [].concat(...arr);
```

### slice(start, end)
- åš xxx += array.length å¤„ç†
- åš Math.floor(Math.abs(xxxx)) å¤„ç†

---

## é€’å½’

### å°¾é€’å½’
å¦å¤–ä¸€ç§å½¢å¼
```js
function trampoline( res ) {
  while (typeof res == "function") {
    res = res();
  }
  return res;
}

var foo = (function(){
  function _foo(acc,x) {
    if (x <= 1) return acc;
    return function partial(){
      return _foo( (x / 2) + acc, x - 1 );
    };
  }

  return function(x) {
    return trampoline( _foo( 1, x ) );
  };
})();
```

- - -

## å…¶ä»–
- åœ¨ ES6 ä¸­ï¼Œå¦‚æœå‚æ•°è¢«çœç•¥æˆ–è€…å€¼ä¸º undefinedï¼Œåˆ™å–è¯¥å‚æ•°çš„é»˜è®¤å€¼
- å‡½æ•°å£°æ˜ä¸å¯ä»¥çœç•¥å‡½æ•°å
- localstorageé™åˆ¶ï¼špcç«¯ï¼š5-10Mï¼Œç§»åŠ¨ç«¯ï¼š2.5M
- æ§åˆ¶åè½¬æ˜¯æ€æƒ³ï¼Œä¾èµ–æ³¨å…¥æ˜¯å…·ä½“å®ç°
  * ä¾èµ–æ³¨å…¥ï¼šå®ä¾‹åœ¨å¤–éƒ¨åˆå§‹åŒ–åä¼ å…¥æ–¹æ³•ï¼Œè€Œä¸æ˜¯åœ¨æ–¹æ³•é‡Œåˆå§‹åŒ–
- è®¾ç½®Errorçš„stackå±‚æ•°ï¼šError.stackTraceLimit = Infinity
- æ–æ³¢é‚£å¥‘æ•°ï¼šfor (var f = 1; number > 1; f *= number--)
- [å¤åˆ¶ç²˜è´´](https://mp.weixin.qq.com/s/2SFPhRVbbtMz3PatKTPF8w)
- [dockeræ“ä½œ](https://mp.weixin.qq.com/s/McViifQcoGhI6M-n1iCXfw)
- [ç£ç›˜è¯»å†™å’Œæ•°æ®åº“è¯»å†™æ•ˆç‡å¯¹æ¯”](https://blog.csdn.net/xiaofei0859/article/details/51147849)
  * ä¸€æ¬¡è¯»å–çš„å†…å®¹è¶Šå¤§ï¼Œç›´æ¥è¯»æ–‡ä»¶çš„ä¼˜åŠ¿ä¼šæ›´æ˜æ˜¾

### ç±»å‹è¯­è¨€
- é™æ€ç±»å‹è¯­è¨€ï¼šåœ¨ç¼–è¯‘æ—¶æœŸå°±æ£€æŸ¥æ•°æ®ç±»å‹çš„ï¼Œæ‰€ä»¥å¿…é¡»åœ¨å£°æ˜å˜é‡çš„æ—¶å€™æŒ‡å®šæ•°æ®ç±»å‹ï¼Œå¦åˆ™ç¼–è¯‘ä¼šä¸é€šè¿‡
- å¼ºç±»å‹è¯­è¨€ï¼šå˜é‡çš„æ•°æ®ç±»å‹ä¸€æ—¦ç¡®å®šä¸‹æ¥ï¼Œå°±ä¸èƒ½æ”¹å˜äº†ï¼Œé™¤éç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢

### eval
- fast pathå’Œslow pathï¼Œevalè¿è¡Œäºslow pathï¼Œè§£æé€Ÿåº¦æ…¢10å€
- åšä»£ç æ··æ·†å‹ç¼©æ—¶å®¹æ˜“æŠ¥é”™
- éš¾ä»¥åšä¼˜åŒ–
- ä¸æ–¹ä¾¿è°ƒè¯•

### èµ‹å€¼nullå’Œundefined
null
- å…¨å±€å˜é‡ï¼šå°†è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆå¯¹è±¡ä»¥åŠå€¼æ¸…ç©º
- å¯¹è±¡å±æ€§ï¼šç»™è¿™ä¸ªå±æ€§åˆ†é…äº†ä¸€å—ç©ºçš„å†…å­˜ï¼Œåƒåœ¾å›æ”¶ä¼šå›æ”¶null

undefined
- å°†è¿™ä¸ªå¯¹è±¡çš„å€¼æ¸…ç©ºï¼Œå¯¹è±¡ä¾æ—§å­˜åœ¨

### å˜é‡å£°æ˜
varå£°æ˜åœ¨å…¨å±€ä½œç”¨åŸŸ

let/constå£°æ˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œç”±{}äº§ç”Ÿ

---

## ç»§æ‰¿

### åŸºæœ¬æ¦‚å¿µ
```js
function F() {}
var f = new F;

F.prototype.constructor ===  F;
F.__proto__ === Function.prototype;
Function.prototype.__proto__ === Object.prototype;
Object.prototype.__proto__ === null;

f.__proto__ === F.prototype;
F.prototype.__proto__ === Object.prototype;
Object.prototype.__proto__ === nulll;
```

### es6çš„ç»§æ‰¿
```js
class Parent {
  constructor(name) {
    this.name = name;
  }

  static sayHello() {
    console.log('hello');
  }

  sayName() {
    console.log(this.name);
  }
}

class Child extends Parent {
  constructor(name, age) {
    super(name);
    this.age = age;
  }

  sayAge() {
    console.log(this.age);
  }
}
```

### es5çš„ç»§æ‰¿
```js
function Parent(name) {
  this.name = name;
};

Parent.sayHello = function() {
  console.log('hello');
};

Parent.prototype.sayName = function() {
  console.log(this.name);
};

function Child(name, age) {
  Parent.call(this, name);
  this.age = age;
};

Child.prototype = Object.create(Parent.prototype, {
  constructor: {
    value: Child,
    writable: true,
    configurable: true,
  },
});

Child.__proto__ = Parent;

// ç›¸å½“äºChild.__proto__ = Parent;
// é™æ€æ–¹æ³•ä¹Ÿä¼šèµ‹äºˆæ–°function
Object.setPrototypeOf(Child, Parent);
Child.prototype.sayAge = function() {
  console.log(this.age);
};

var parent = new Parent('Parent');
var child = new Child('Child', 8);

console.log(parent);
console.log(child);

Parent.sayHello();
Child.sayHello();

parent.sayName();
child.sayName();
child.sayAge();

console.log(child.__proto__ === Child.prototype);
console.log(Child.prototype.__proto__ === Parent.prototype);
console.log(Parent.prototype.__proto__ === Object.prototype);
```

### webpackçš„ç»§æ‰¿
```js
function _classCallCheck(instance, Klass) {
  if (!(instance instanceof Klass)) {
    throw new Error('Cannot call a class as a function');
  }
};

function _defineProperties(target, props) {
  for (var i = 0, len = props.length; i < len; i += 1) {
    const descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ('value' in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
};

function _inherit(Child, Parent) {
  Child.prototype = Object.create(Parent.prototype, {
    constructor: {
      value: Child,
      writable: true,
      configurable: true,
    },
  });
  Object.setPrototypeOf(Child, Parent);
};

function _createClass(Klass, protoProps, staticProps) {
  if (protoProps) {
    _defineProperties(Klass.prototype, protoProps);
  }

  if (staticProps) {
    _defineProperties(Klass, staticProps);
  }
};

var Parent = (function() {
  function Parent(name) {
    _classCallCheck(this, Parent);
    this.name = name;
  }

  _createClass(Parent, [{
    key: 'sayName',
    value: function sayName() {
      console.log(this.name);
    }
  }], [{
    key: 'sayHello',
    value: function sayHello() {
      console.log('hello');
    }
  }]);
  return Parent;
} ());

var Child = (function(_Parent) {
  _inherit(Child, _Parent);
  function Child() {
    // ...
    // _possibleConstructorReturn
  };
} (Parent));
```

---

## æ·±æ‹·è´

### ä¸è€ƒè™‘symbolçš„æƒ…å†µ
```js
const isObject = val => val && typeof val === 'object';
const has = (list = [], child) => {
  for (let item of list) {
    const [ source, target ] = item;
    if (source === child) {
      return target;
    }
  }
};
const deepClone = (source, uniqList = []) => {
  if (!isObject(source)) return source;
  let target = has(uniqList, source);
  if (!target) {
    target = Array.isArray(source) ? [] : {};
    for (let key in source) {
      const ssValue = source[key];
      if (isObject(ssValue)) {
        target[key] = deepClone(ssValue, uniqList);
        uniqList.push([ssValue, target[key]]);
      } else {
        target[key] = ssValue;
      }
    }
  }
  return target;  
};
```

### è€ƒè™‘symbolçš„æƒ…å†µ
```js
// æ–¹å¼1
const deepClone = (source, uniqList = []) => {
  if (!isObject(source)) return source;
  let target = has(uniqList, source);
  if (!target) {
    target = Array.isArray(source) ? [] : {};
    const symbolKeys = Object.getOwnPropertySymbols(source);

    for (let sKey of symbolKeys) {
      const symbolValue = source[sKey];
      if (isObject(symbolValue)) {
        target[sKey] = deepClone(symbolValue, uniqList);
      } else {
        target[sKey] = symbolValue;
      }
    }

    for (let key in source) {
      const ssValue = source[key];
      if (source.hasOwnProperty(key) && isObject(ssValue)) {
        target[key] = deepClone(ssValue, uniqList);
        uniqList.push([ssValue, target[key]]);
      } else {
        target[key] = ssValue;
      }
    }
  }
  return target;  
};

// æ–¹å¼2 - es6
const deepClone = (source, uniqMap = new WeakMap()) => {
  if (!isObject(source)) return source;
  if (uniqMap.has(source)) return uniqMap.get(source);
  let target = Array.isArray(source) ? [ ...source ] : { ...source };
  uniqMap.set(source, target);
  Reflect.ownKeys(target).forEach((key) => {
    const ssValue = source[key];
    if (isObject(ssValue)) {
      target[key] = deepClone(ssValue, uniqMap);
    } else {
      target[key] = ssValue;
    }
  });
  return target;
};
```

### åº”å¯¹çˆ†æ ˆé—®é¢˜
```js
const deepClone = (source) => {
  const root = {};

    // æ ˆ
    const loopList = [
        {
            parent: root,
            key: undefined,
            data: x,
        }
    ];

    while(loopList.length) {
        // æ·±åº¦ä¼˜å…ˆ
        const node = loopList.pop();
        const parent = node.parent;
        const key = node.key;
        const data = node.data;

        // åˆå§‹åŒ–èµ‹å€¼ç›®æ ‡ï¼Œkeyä¸ºundefinedåˆ™æ‹·è´åˆ°çˆ¶å…ƒç´ ï¼Œå¦åˆ™æ‹·è´åˆ°å­å…ƒç´ 
        let res = parent;
        if (typeof key !== 'undefined') {
            res = parent[key] = {};
        }

        for(let k in data) {
            if (data.hasOwnProperty(k)) {
                if (typeof data[k] === 'object') {
                    // ä¸‹ä¸€æ¬¡å¾ªç¯
                    loopList.push({
                        parent: res,
                        key: k,
                        data: data[k],
                    });
                } else {
                    res[k] = data[k];
                }
            }
        }
    }
    return root;
};
```

---

## å­—èŠ‚
[è®¡ç®—å­—ç¬¦ä¸²æ‰€å å­—èŠ‚æ•°](http://www.cnblogs.com/1175429393wljblog/p/4562736.html)

### utf8å’Œutf16
* utf8 - å˜é•¿å­—ç¬¦ç¼–ç 
  - 1å­—èŠ‚ï¼š000000 - 00007Fï¼ˆ128ä¸ªï¼‰
  - 2å­—èŠ‚ï¼š000080 - 0007FFï¼ˆ1920ä¸ªï¼‰
  - 3å­—èŠ‚ï¼š000800 - 00D7FF å’Œ 00E000 - 00FFFFï¼ˆ61440ä¸ªï¼‰
    æ³¨ï¼šD800-DFFF ä¸­ä¸å­˜åœ¨ä»»ä½•å­—ç¬¦
  - 4å­—èŠ‚ï¼š010000 - 10FFFFï¼ˆ1048576ä¸ªï¼‰
* utf16 - å®šé•¿å­—ç¬¦ç¼–ç ï¼ˆå…¶å®ä¹Ÿç®—å˜é•¿å­—ç¬¦ï¼‰
  - 2å­—èŠ‚ï¼š000000 â€“ 00FFFF
  - 4å­—èŠ‚ï¼š010000 â€“ 10FFFF

### æ‹“å±•
Javaç®€å•æ•°æ®ç±»å‹ä¸­æ‰€å å­—ç¬¦ä¸å®šï¼š
- floatå ç”¨ 4 å­—èŠ‚
- double 8 å­—èŠ‚
- byte 1å­—èŠ‚ -128åˆ°127
- short 2 å­—èŠ‚
- int 4 å­—èŠ‚
- long 8 å­—èŠ‚

---

## èŠ‚æµvsé˜²æŠ–
**èŠ‚æµ(throttle)**

æ¯éš”ä¸€æ®µæ—¶é—´åæ‰§è¡Œä¸€æ¬¡

**é˜²æŠ– (debounce)**

å°†å¤šæ¬¡é«˜é¢‘æ“ä½œä¼˜åŒ–ä¸ºåªåœ¨æœ€åä¸€æ¬¡æ‰§è¡Œ

---

## æ–‡ä»¶ä¸‹è½½

### ç”Ÿæˆä¸‹è½½å­—ç¬¦ä¸²æ–‡ä»¶
```html
<!-- è¦è®¾ç½®download -->
<a download="xxx.json" id="mylink" href="#">click download</a>
```
```js
const debug = {hello: "world"};
const blob = new Blob([JSON.stringify(debug, null, 2)], {type : 'application/json'});

// ç”Ÿæˆblobé“¾æ¥
const objectURL = URL.createObjectURL(blob);
const link = document.getElementById('mylink');
link.setAttribute('href', objectURL);

// ä¸ºé¿å…å†…å­˜è¿‡åº¦å ç”¨ï¼Œåœ¨å®‰å…¨æ—¶æœºåˆ é™¤url
URL.revokeObjectURL(objectURL)
```

### è¯»å–æ–‡ä»¶
```js
const reader = new FileReader();
const debug = {hello: "world"};
const blob = new Blob([JSON.stringify(debug, null, 2)], {type : 'application/json'});

reader.onloadend = function onload() {
  console.log(reader.result);
};
reader.readAsDataURL(blob);
reader.readAsText(blob);
```

---
