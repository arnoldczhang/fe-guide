##参考
- https://juejin.im/post/5a2559ae6fb9a044fe4634ba?utm_medium=fe&utm_source=weixinqun
- https://zcfy.cc/article/how-javascript-works-memory-management-how-to-handle-4-common-memory-leaks
- https://en.wikipedia.org/wiki/Tracing_garbage_collection
- https://blog.csdn.net/xiepeifeng/article/details/43341113

## 目录
<details>
<summary>展开更多</summary>

* [`原因`](#原因)
* [`基本概念`](#基本概念)
* [`堆/栈内存`](#堆内存和栈内存)
* [`垃圾回收算法`](#垃圾回收算法)
* [`内存查看`](#内存查看)

</details>

## 原因
1. 全局变量
2. setInterval
3. 闭包
4. 超出dom引用（比如dom和js中都保留了对节点的引用，dom即使removechild了，js中的引用还存在）

## 基本概念
- 8位一字节
- 整型2字节
- 双精度4字节

## 堆内存和栈内存
- 栈内存
  1. 大小确认
  2. 编译时分配
  3. LIFO（后进先出）
  4. 基本类型、定长数组
  5. cpu有特定寄存器（esp、ebp）来操作栈，速度快
- 堆内存
  1. 大小不定
  2. 运行时分配
  3. 对象
  4. 堆通过间接寻址操作，速度较栈慢

## 垃圾回收算法
- 引用计数（现代浏览器不再使用）
  - 循环引用造成计数不为0，无法清除
- 标记清除（常用）
  - 取全局变量（window或global）作为根元素，子元素递归检查是否为活跃的

## 内存查看

### node环境
```js
console.log(process.memoryUsage());

// 输出
{ 
  rss: 27709440,        // resident set size，所有内存占用，包括指令区和堆栈
  heapTotal: 5685248,   // "堆"占用的内存，包括用到的和没用到的
  heapUsed: 3449392,    // 用到的堆的部分
  external: 8772         // V8 引擎内部的 C++ 对象占用的内存
}
```

### 浏览器环境
devtool->memory -> take snapshot

#### 名词解释
Distance：到root的引用距离
Shallow size：对象本身的大小，不包含它引用的数据的大小
Retained size：对象自身以及所有引用的大小，就是对象总共占用的内存
