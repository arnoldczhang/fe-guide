# 网络安全

## CSP

### 原理
  - 在HTTP Header中声明一个随机字符串，在HTML中的JavaScript标签上带了nonce属性，nonce的值和Header指定的一致才会执行对应的JavaScript代码

### 具体操作
```js
// .html or template
<script nonce="aaaa" >alert('aaaa')</script>
<script nonce="bbbb" >alert('bbbb')</script>

// 方式一：koa
// app.js
app.user(async function(ctx) {
  ctx.set('Content-Security-Policy', "script-src 'nonce-aaaa'");
  // ...
});

// 方式二：nginx
// nginx.conf
location / {
  add_header Content-Security-Policy "script-src 'nonce-aaaa'";
}
```

### 参考
1. https://www.zhihu.com/question/21979782/answer/42920769